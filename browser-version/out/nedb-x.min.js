!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Nedb=t()}}(function(){return function(){return function t(e,n,r){function i(a,u){if(!n[a]){if(!e[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[a]={exports:{}};e[a][0].call(f.exports,function(t){return i(e[a][1][t]||t)},f,f.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}}()({1:[function(t,e,n){var r=Object.create||function(t){var e=function(){};return e.prototype=t,new e},i=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return n},o=Function.prototype.bind||function(t){var e=this;return function(){return e.apply(t,arguments)}};function a(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=r(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._maxListeners=void 0;var u,s=10;try{var c={};Object.defineProperty&&Object.defineProperty(c,"x",{value:0}),u=0===c.x}catch(t){u=!1}function f(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function l(t,e,n,i){var o,a,u;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((a=t._events)?(a.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),a=t._events),u=a[e]):(a=t._events=r(null),t._eventsCount=0),u){if("function"==typeof u?u=a[e]=i?[n,u]:[u,n]:i?u.unshift(n):u.push(n),!u.warned&&(o=f(t))&&o>0&&u.length>o){u.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+u.length+' "'+String(e)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');s.name="MaxListenersExceededWarning",s.emitter=t,s.type=e,s.count=u.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",s.name,s.message)}}else u=a[e]=n,++t._eventsCount;return t}function h(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];this.listener.apply(this.target,t)}}function p(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=o.call(h,r);return i.listener=n,r.wrapFn=i,i}function d(t,e,n){var r=t._events;if(!r)return[];var i=r[e];return i?"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):v(i,i.length):[]}function y(t){var e=this._events;if(e){var n=e[t];if("function"==typeof n)return 1;if(n)return n.length}return 0}function v(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}u?Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!=typeof t||t<0||t!=t)throw new TypeError('"defaultMaxListeners" must be a positive number');s=t}}):a.defaultMaxListeners=s,a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return f(this)},a.prototype.emit=function(t){var e,n,r,i,o,a,u="error"===t;if(a=this._events)u=u&&null==a.error;else if(!u)return!1;if(u){if(arguments.length>1&&(e=arguments[1]),e instanceof Error)throw e;var s=new Error('Unhandled "error" event. ('+e+")");throw s.context=e,s}if(!(n=a[t]))return!1;var c="function"==typeof n;switch(r=arguments.length){case 1:!function(t,e,n){if(e)t.call(n);else for(var r=t.length,i=v(t,r),o=0;o<r;++o)i[o].call(n)}(n,c,this);break;case 2:!function(t,e,n,r){if(e)t.call(n,r);else for(var i=t.length,o=v(t,i),a=0;a<i;++a)o[a].call(n,r)}(n,c,this,arguments[1]);break;case 3:!function(t,e,n,r,i){if(e)t.call(n,r,i);else for(var o=t.length,a=v(t,o),u=0;u<o;++u)a[u].call(n,r,i)}(n,c,this,arguments[1],arguments[2]);break;case 4:!function(t,e,n,r,i,o){if(e)t.call(n,r,i,o);else for(var a=t.length,u=v(t,a),s=0;s<a;++s)u[s].call(n,r,i,o)}(n,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];!function(t,e,n,r){if(e)t.apply(n,r);else for(var i=t.length,o=v(t,i),a=0;a<i;++a)o[a].apply(n,r)}(n,c,this,i)}return!0},a.prototype.addListener=function(t,e){return l(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return l(this,t,e,!0)},a.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,p(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,p(this,t,e)),this},a.prototype.removeListener=function(t,e){var n,i,o,a,u;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(n=i[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=r(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,a=n.length-1;a>=0;a--)if(n[a]===e||n[a].listener===e){u=n[a].listener,o=a;break}if(o<0)return this;0===o?n.shift():function(t,e){for(var n=e,r=n+1,i=t.length;r<i;n+=1,r+=1)t[n]=t[r];t.pop()}(n,o),1===n.length&&(i[t]=n[0]),i.removeListener&&this.emit("removeListener",t,u||e)}return this},a.prototype.removeAllListeners=function(t){var e,n,o;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=r(null),this._eventsCount=0):n[t]&&(0==--this._eventsCount?this._events=r(null):delete n[t]),this;if(0===arguments.length){var a,u=i(n);for(o=0;o<u.length;++o)"removeListener"!==(a=u[o])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=r(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(e)for(o=e.length-1;o>=0;o--)this.removeListener(t,e[o]);return this},a.prototype.listeners=function(t){return d(this,t,!0)},a.prototype.rawListeners=function(t){return d(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):y.call(t,e)},a.prototype.listenerCount=y,a.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],2:[function(t,e,n){(function(t){function e(t,e){for(var n=0,r=t.length-1;r>=0;r--){var i=t[r];"."===i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}n.resolve=function(){for(var n="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var a=o>=0?arguments[o]:t.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(n=a+"/"+n,i="/"===a.charAt(0))}return n=e(r(n.split("/"),function(t){return!!t}),!i).join("/"),(i?"/":"")+n||"."},n.normalize=function(t){var o=n.isAbsolute(t),a="/"===i(t,-1);return(t=e(r(t.split("/"),function(t){return!!t}),!o).join("/"))||o||(t="."),t&&a&&(t+="/"),(o?"/":"")+t},n.isAbsolute=function(t){return"/"===t.charAt(0)},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(r(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},n.relative=function(t,e){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=n.resolve(t).substr(1),e=n.resolve(e).substr(1);for(var i=r(t.split("/")),o=r(e.split("/")),a=Math.min(i.length,o.length),u=a,s=0;s<a;s++)if(i[s]!==o[s]){u=s;break}var c=[];for(s=u;s<i.length;s++)c.push("..");return(c=c.concat(o.slice(u))).join("/")},n.sep="/",n.delimiter=":",n.dirname=function(t){if("string"!=typeof t&&(t+=""),0===t.length)return".";for(var e=t.charCodeAt(0),n=47===e,r=-1,i=!0,o=t.length-1;o>=1;--o)if(47===(e=t.charCodeAt(o))){if(!i){r=o;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":t.slice(0,r)},n.basename=function(t,e){var n=function(t){"string"!=typeof t&&(t+="");var e,n=0,r=-1,i=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!i){n=e+1;break}}else-1===r&&(i=!1,r=e+1);return-1===r?"":t.slice(n,r)}(t);return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},n.extname=function(t){"string"!=typeof t&&(t+="");for(var e=-1,n=0,r=-1,i=!0,o=0,a=t.length-1;a>=0;--a){var u=t.charCodeAt(a);if(47!==u)-1===r&&(i=!1,r=a+1),46===u?-1===e?e=a:1!==o&&(o=1):-1!==e&&(o=-1);else if(!i){n=a+1;break}}return-1===e||-1===r||0===o||1===o&&e===r-1&&e===n+1?"":t.slice(e,r)};var i="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,t("_process"))},{_process:3}],3:[function(t,e,n){var r,i,o=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(t){r=a}try{i="function"==typeof clearTimeout?clearTimeout:u}catch(t){i=u}}();var c,f=[],l=!1,h=-1;function p(){l&&c&&(l=!1,c.length?f=c.concat(f):h=-1,f.length&&d())}function d(){if(!l){var t=s(p);l=!0;for(var e=f.length;e;){for(c=f,f=[];++h<e;)c&&c[h].run();h=-1,e=f.length}c=null,l=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===u||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function y(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];f.push(new y(t,e)),1!==f.length||l||s(d)},y.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],4:[function(t,e,n){(function(e,r){var i=t("process/browser.js").nextTick,o=Function.prototype.apply,a=Array.prototype.slice,u={},s=0;function c(t,e){this._id=t,this._clearFn=e}n.setTimeout=function(){return new c(o.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new c(o.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(t){t.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},n.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},n._unrefActive=n.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n.setImmediate="function"==typeof e?e:function(t){var e=s++,r=!(arguments.length<2)&&a.call(arguments,1);return u[e]=!0,i(function(){u[e]&&(r?t.apply(null,r):t.call(null),n.clearImmediate(e))}),e},n.clearImmediate="function"==typeof r?r:function(t){delete u[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":3,timers:4}],5:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],6:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],7:[function(t,e,n){(function(e,r){var i=/%[sdj%]/g;n.format=function(t){if(!g(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(u(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(t).replace(i,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),s=r[n];n<o;s=r[++n])y(s)||!b(s)?a+=" "+s:a+=" "+u(s);return a},n.deprecate=function(t,i){if(m(r.process))return function(){return n.deprecate(t,i).apply(this,arguments)};if(!0===e.noDeprecation)return t;var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(i);e.traceDeprecation?console.trace(i):console.error(i),o=!0}return t.apply(this,arguments)}};var o,a={};function u(t,e){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),d(e)?r.showHidden=e:e&&n._extend(r,e),m(r.showHidden)&&(r.showHidden=!1),m(r.depth)&&(r.depth=2),m(r.colors)&&(r.colors=!1),m(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=s),f(r,t,r.depth)}function s(t,e){var n=u.styles[e];return n?"["+u.colors[n][0]+"m"+t+"["+u.colors[n][1]+"m":t}function c(t,e){return t}function f(t,e,r){if(t.customInspect&&e&&k(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(r,t);return g(i)||(i=f(t,i,r)),i}var o=function(t,e){if(m(e))return t.stylize("undefined","undefined");if(g(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(v(e))return t.stylize(""+e,"number");if(d(e))return t.stylize(""+e,"boolean");if(y(e))return t.stylize("null","null")}(t,e);if(o)return o;var a=Object.keys(e),u=function(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(e)),x(e)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(e);if(0===a.length){if(k(e)){var s=e.name?": "+e.name:"";return t.stylize("[Function"+s+"]","special")}if(_(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(w(e))return t.stylize(Date.prototype.toString.call(e),"date");if(x(e))return l(e)}var c,b="",E=!1,A=["{","}"];(p(e)&&(E=!0,A=["[","]"]),k(e))&&(b=" [Function"+(e.name?": "+e.name:"")+"]");return _(e)&&(b=" "+RegExp.prototype.toString.call(e)),w(e)&&(b=" "+Date.prototype.toUTCString.call(e)),x(e)&&(b=" "+l(e)),0!==a.length||E&&0!=e.length?r<0?_(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special"):(t.seen.push(e),c=E?function(t,e,n,r,i){for(var o=[],a=0,u=e.length;a<u;++a)I(e,String(a))?o.push(h(t,e,n,r,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(h(t,e,n,r,i,!0))}),o}(t,e,r,u,a):a.map(function(n){return h(t,e,r,u,n,E)}),t.seen.pop(),function(t,e,n){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(c,b,A)):A[0]+b+A[1]}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,r,i,o){var a,u,s;if((s=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?u=s.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):s.set&&(u=t.stylize("[Setter]","special")),I(r,i)||(a="["+i+"]"),u||(t.seen.indexOf(s.value)<0?(u=y(n)?f(t,s.value,null):f(t,s.value,n-1)).indexOf("\n")>-1&&(u=o?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n")):u=t.stylize("[Circular]","special")),m(a)){if(o&&i.match(/^\d+$/))return u;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+u}function p(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function y(t){return null===t}function v(t){return"number"==typeof t}function g(t){return"string"==typeof t}function m(t){return void 0===t}function _(t){return b(t)&&"[object RegExp]"===E(t)}function b(t){return"object"==typeof t&&null!==t}function w(t){return b(t)&&"[object Date]"===E(t)}function x(t){return b(t)&&("[object Error]"===E(t)||t instanceof Error)}function k(t){return"function"==typeof t}function E(t){return Object.prototype.toString.call(t)}function A(t){return t<10?"0"+t.toString(10):t.toString(10)}n.debuglog=function(t){if(m(o)&&(o=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!a[t])if(new RegExp("\\b"+t+"\\b","i").test(o)){var r=e.pid;a[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,r,e)}}else a[t]=function(){};return a[t]},n.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=p,n.isBoolean=d,n.isNull=y,n.isNullOrUndefined=function(t){return null==t},n.isNumber=v,n.isString=g,n.isSymbol=function(t){return"symbol"==typeof t},n.isUndefined=m,n.isRegExp=_,n.isObject=b,n.isDate=w,n.isError=x,n.isFunction=k,n.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},n.isBuffer=t("./support/isBuffer");var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function I(t,e){return Object.prototype.hasOwnProperty.call(t,e)}n.log=function(){var t,e;console.log("%s - %s",(t=new Date,e=[A(t.getHours()),A(t.getMinutes()),A(t.getSeconds())].join(":"),[t.getDate(),O[t.getMonth()],e].join(" ")),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!b(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":6,_process:3,inherits:5}],8:[function(t,e,n){var r=t("./../lib/model");const{concatSeries:a}=t("async");n.extend=function(t){function e(t,e){var n=[];for(var r in t)n.push(t[r][e]);if(0===n.length)return 0;n.sort(function(t,e){return t-e});var i=Math.floor(n.length/2);return n.length%2?n[i]:(n[i-1]+n[i])/2}t.prototype.aggregates=function(t){return this._aggregates=t,this},t.prototype._computeAggregates=function(t,n,r){var i=r.length;for(var a in r){var u=r[a];for(var s in n){var c=n[s][0],f=n[s][1],l=parseFloat(u[f]);switch(c){case"sum":case"avg":void 0==t[s]?t[s]=l:t[s]+=l;break;case"min":void 0==t[s]?t[s]=l:l<t[s]&&(t[s]=l);break;case"max":void 0==t[s]?t[s]=l:l>t[s]&&(t[s]=l);break;case"count":case"median":break;default:throw new Error("NoAggregateFunction: ",o[0])}}}for(var s in n)c=n[s][0],f=n[s][1],"avg"==c?t[s]=t[s]/i:"count"==c?t[s]=i:"median"==c&&(t[s]=e(r,f));return t},t.prototype.groupBy=function(t){return this._groupByAttribute=t,this},t.prototype.withRollup=function(){return this._withRollup=!0,this},t.prototype._groupBy=function(t){var e=this._groupByAttribute,n=this._aggregates||[],r={};for(var i in t)void 0==r[t[i][e]]&&(r[t[i][e]]=[]),r[t[i][e]].push(t[i]);var o=[];for(var i in r){var a={[e]:i};a=this._computeAggregates(a,n,r[i]),o.push(a)}return!0===this._withRollup&&(a={[e]:null,__meta:{rollupRow:!0}},this._rollupRecord=this._computeAggregates(a,n,t)),o},t.prototype._sortFunc=function(t){var e,n,o=this;this.sortObj&&this._sortObj[this._modelName]?sort=this._sortObj[this._modelName]:sort=this._sort,e=Object.keys(sort);var a=[];for(i=0;i<e.length;i++)n=e[i],a.push({key:n,direction:sort[n]});return t.sort(function(t,e){var n,i,u;for(u=0;u<a.length;u++)if(0!=(i=(n=a[u]).direction*r.compareThings(r.getDotValue(t,n.key),r.getDotValue(e,n.key),o.db.compareStrings)))return i;return 0}),t},t.prototype._limitAndOffset=function(t){var e=this._limit||t.length,n=this._skip||0;return t=t.slice(n,n+e)},t.prototype._asyncGetCandidates=async function(t){return new Promise((e,n)=>{this.db.getCandidates(t,function(i,o){var a=[];if(i)return n(i);try{for(var u=0;u<o.length;u+=1)r.match(o[u],t)&&a.push(o[u]);var s=[];for(var c in a)s.push({...a[c]});e(s)}catch(i){return n(i)}})})},t.prototype._addModelNameToAttributes=function(t,e){var n=r.deepCopy(t);for(var i in n)for(var o in n[i])"__meta"!=o&&(n[i][e+":"+o]=n[i][o],delete n[i][o]);return n},t.prototype._recursiveSearchModelTypes=function(t,e){if("string"==typeof e&&2==(r=e.split(":")).length&&-1==t.indexOf(r[0])&&t.push(r[0]),Array.isArray(e))for(var n in e)this._recursiveSearchModelTypes(t,e[n]);else for(var n in e){var r,i=e[n];Array.isArray(i)?this._recursiveSearchModelTypes(t,i):2==(r=n.split(":")).length&&-1==t.indexOf(r[0])&&t.push(r[0])}},t.prototype._recursiveSplitModelCriteria=function(t,e){if("string"==typeof e)return e;if(Array.isArray(e)){var n=[];for(var r in e)n.push(this._recursiveSplitModelCriteria(t,e[r]))}else for(var r in n={},e){var i=e[r];if(Array.isArray(i))n[r]=this._recursiveSplitModelCriteria(t,i);else{var o=r.split(":");if(2==o.length)o[0]==t&&(o[0]==this._modelName?n[o[1]]=i:n[r]=i);else{if("_model"==r&&t!==i)continue;n[r]=i}}}return n},t.prototype._prepareQueryDataForJoin=function(t){t=t||this._query;var e=[];for(var n in this._recursiveSearchModelTypes(e,t),this._queryObj={},e){var r=this._recursiveSplitModelCriteria(e[n],t);console.log("Criteria for ",e[n]),this._queryObj[e[n]]=r}for(var n in this._sortObj={},e)r=this._recursiveSplitModelCriteria(e[n],this._sort),console.log("Sort for ",e[n]),this._sortObj[e[n]]=r},t.prototype._getData=async function(t){var e=[];this._searchCriteria&&(t=t&&Object.keys(t).length>0?{$and:[t,this._searchCriteria]}:this._searchCriteria);let n=Object.keys(t).length;if(this._hasQuery=!!(t&&n>0),this._leftJoin&&this._prepareQueryDataForJoin(t),!0===this._asTree){this._projection&&(this._projection.__meta=1),this._getChildrenCount();let a=void 0!==(t=this._queryObj?this._queryObj[this._modelName]:t)._model&&n>1;if(this._hasQuery&&(a||this._searchCriteria)){var r=await this._asyncGetCandidates(t),i=r.map(t=>t._id);for(var o in e=await this._getTreeDataFromNodeUp(r))e[o].__meta||(e[o].__meta={}),e[o].__meta.__criteriaMatch=-1!==i.indexOf(e[o]._id);e=this._sortListAsTree(e)}else e=await this._getTreeDataFromTop(t)}if(this._modelName&&this._leftJoin){for(var o in this._asTree||(t=Object.assign({},this._queryObj[this._modelName]||{},{_model:this._modelName}),e=await this._asyncGetCandidates(t)),e=this._addModelNameToAttributes(e,this._modelName),this._leftJoin)e=await this._leftJoinData(e,this._leftJoin[o],this._queryObj);this._asTree&&(this._treeId=this._modelName+":"+this._treeId,this._treeParentId=this._modelName+":"+this._treeParentId,e=this._sortListAsTree(e))}return this._leftJoin||this._asTree||(e=await this._asyncGetCandidates(t)),e},t.prototype._sortListAsTree=function(t){var e={};for(var n in t){var r=t[n][this._treeParentId];void 0!=r&&null!=r||(r=null),void 0==e[r]&&(e[r]=[]),e[r].push(t[n])}if(this._sort)for(var n in e)e[n]=this._sortFunc(e[n]);return this._addRecursively("null",e)},t.prototype._addRecursively=function(t,e,n){var r=[],i=(n=n||0,e[t]||[]);for(var o in i){var a=i[o];a.__meta||(a.__meta={}),a.__meta.__level=n,this._childCount[a.id]?a.__meta.__childCount=this._childCount[a.id]:a.__meta.__childCount=0,r.push(a),r=r.concat(this._addRecursively(a[this._treeId],e,n+1))}return r},t.prototype._getChildrenCount=async function(){let t=this._modelName?{_model:this._modelName}:{},e=await this._asyncGetCandidates(t),n={};for(var r in e){let t=e[r].__parent;void 0==n[t=void 0==t||null==t||""==t?null:t]?n[t]=1:n[t]++}this._childCount=n},t.prototype._getTreeDataFromTop=async function(t,e,n){var r=[],i=(e=e||void 0,n=void 0==n?0:n+1,this._treeParentId);e?(delete t.$where,t[this._treeParentId]=e):t.$where=function(){return!this[i]};var o=await this._asyncGetCandidates(t);for(var a in this._sort&&(o=this._sortFunc(o)),o)o[a].__meta||(o[a].__meta={}),o[a].__meta.__level=n,this._childCount[o[a].id]?o[a].__meta.__childCount=this._childCount[o[a].id]:o[a].__meta.__childCount=0,r.push(o[a]),o[a][this._treeId]&&(!0!==this._openAll&&-1===this._openTreeIds.indexOf(o[a][this._treeId])||(r=r.concat(await this._getTreeDataFromTop(t,o[a][this._treeId],n))));return r},t.prototype._getTreeDataFromNodeUp=async function(t,e){var n=[].concat(t);for(var r in e||(e=n.map(t=>t._id)),t){var i=t[r];if(i[this._treeParentId]){var o={};this._modelName&&(o._model=this._modelName),o.id=i[this._treeParentId];var a=await this._asyncGetCandidates(o);1==a.length&&-1==e.indexOf(a[0]._id)&&(e.push(a[0]._id),n=n.concat(await this._getTreeDataFromNodeUp(a,e)))}}return n},t.prototype._leftJoinData=async function(t,e,n){var i=e.to.split(":");let o=[];var a=[];for(var u in t)void 0!==t[u][e.from]&&-1==a.indexOf(t[u][e.from])&&a.push(t[u][e.from]);var s=await this._asyncGetCandidates({_model:i[0]});s=this._addModelNameToAttributes(s,i[0]);var c={};for(var u in s)void 0==c[s[u][e.to]]&&(c[s[u][e.to]]=[]),c[s[u][e.to]].push(s[u]);for(var u in t){var f=t[u][e.from];if(c[f])for(var l in c[f])o.push(Object.assign({},t[u],c[f][l]));else t[u][i[0]]=null,o.push(t[u])}if(t=o,void 0!==n[i[0]]){for(var h=n[i[0]],p=[],d=0;d<t.length;d+=1)r.match(t[d],h)&&p.push(t[d]);return p}return t},t.prototype._exec=async function(t){var e=[],n=this,r=null;function i(e,r){return n.execFn?n.execFn(e,r,t):t(e,r)}if(e=await this._getData(this.query),this._groupByAttribute)e=this._groupBy(e);else if(this._aggregates)return i(r,[e=this._computeAggregates({},this._aggregates,e)]);this._sort&&!0!==this._asTree&&(e=this._sortFunc(e)),e=this._limitAndOffset(e),this._rollupRecord&&e.push(this._rollupRecord);try{e=this.project(e)}catch(t){r=t,e=void 0}return i(r,e)},t.prototype.leftJoin=function(t,e){return void 0==this._leftJoin&&(this._leftJoin=[]),this._leftJoin.push({from:t,to:e}),this},t.prototype.asTree=function(t){return this._asTree=!0,(t=t||{}).openTreeIds?this._openTreeIds=[].concat(t.openTreeIds):this._openTreeIds=[],this._openAll=!0===t.openAll,this._withChildrenCount=!0===t._withChildrenCount,this._withChildrenCount=!0,this._treeId=t.treeId||"id",this._treeParentId=t.treeParentId||"__parent",this},t.prototype.search=function(t,e,n){if("string"!=typeof t)throw new Error("ProvideSearchTerm");"[object RegExp]"!==Object.prototype.toString.call(t)&&(t=new RegExp(t,!0===n?"":"i"));var r=[];for(var i in e)r.push({[e[i]]:t});return this._searchCriteria={$or:r},this}}},{"./../lib/model":22,async:25}],9:[function(t,e,n){n.extend=function(t){t.prototype.model=function(t){return this._modelName=t,this},t.prototype.__setModelInQuery=function(t){if(t&&this._modelName){if(Array.isArray(t))for(var e in t)t[e]._model=this._modelName;else t._model=this._modelName;this._modelName=void 0}return t};var e=t.prototype.insert;t.prototype.insert=function(t,n){return t=this.__setModelInQuery(t),e.apply(this,[t,n])};var n=t.prototype.count;t.prototype.count=function(t,e){return t=this.__setModelInQuery(t),n.apply(this,[t,e])};var r=t.prototype.find;t.prototype.find=function(t,e){t=this.__setModelInQuery(t);var n=r.apply(this,[t,e]);return void 0!==t._model&&(n._modelName=t._model),n};var i=t.prototype.findOne;t.prototype.findOne=function(t,e,n){return t=this.__setModelInQuery(t),i.apply(this,[t,e,n])};var o=t.prototype._remove;t.prototype._remove=function(t,e,n){return t=this.__setModelInQuery(t),o.apply(this,[t,e,n])};var a=t.prototype._update;t.prototype._update=function(t,e,n,r){return this._modelName&&(t&&(t._model=this._modelName),e&&delete e._model,this._modelName=void 0),a.apply(this,[t,e,n,r])}}},{}],10:[function(t,e,n){n.extend=function(t){t.prototype.groupBy=function(){return this.__original.groupBy.apply(this.__original,arguments),this},t.prototype.aggregates=function(){return this.__original.aggregates.apply(this.__original,arguments),this},t.prototype.withRollup=function(){return this.__original.withRollup.apply(this.__original,arguments),this},t.prototype.leftJoin=function(){return this.__original.leftJoin.apply(this.__original,arguments),this},t.prototype.asTree=function(){return this.__original.asTree.apply(this.__original,arguments),this},t.prototype.search=function(){return this.__original.search.apply(this.__original,arguments),this}}},{}],11:[function(t,e,n){n.extend=function(t){t.prototype.model=function(){return this.__original.model.apply(this.__original,arguments),this},t.prototype.logTree=function(t,e,n){for(var r in e=e||"name",t){var i="";t[r].__meta||(t[r].__meta={});for(var o=0;o<t[r].__meta.__level;o++)i+="  ";if(t[r].__meta.__level>0&&(i+="└─ "),t[r].__meta&&!1===t[r].__meta.__criteriaMatch)var a="[30m%s[0m";else a="";if("function"==typeof e)var u=e.apply(this,[t[r]]);else u=void 0!==t[r][e]?t[r][e]:`-unknown attribute '${e}'-`;t[r].__meta.__childCount>0&&(u+=` (children: ${t[r].__meta.__childCount})`),console.log(a,`${i}${u}`)}}}},{}],12:[function(t,e,n){const r=t("./../lib/cursor");t("./../lib-extension/extendOriginalCursor").extend(r);class i{constructor(t,e,n){if(!(t instanceof r))throw new TypeError(`Unexpected ${typeof t}, expected: Cursor (nedb/lib/cursor)`);e instanceof Promise||(e=Promise.resolve()),Object.defineProperties(this,{__original:{configurable:!1,enumerable:!1,writable:!1,value:t},__prerequisite:{configurable:!1,enumerable:!1,writable:!1,value:e},__callback:{configurable:!1,enumerable:!1,writable:!1,value:n}})}sort(){return this.__original.sort.apply(this.__original,arguments),this}skip(){return this.__original.skip.apply(this.__original,arguments),this}limit(){return this.__original.limit.apply(this.__original,arguments),this}exec(){return this.__prerequisite.then(()=>new Promise((t,e)=>{this.__original.exec((n,r)=>("function"==typeof this.__callback&&this.__callback(n,r),n?e(n):t(r)))}))}then(t,e){return this.exec().then(t,e)}catch(t){return this.exec().catch(t)}}t("./../lib-extension/extendPromiseCursor").extend(i),e.exports=i},{"./../lib-extension/extendOriginalCursor":8,"./../lib-extension/extendPromiseCursor":10,"./../lib/cursor":17}],13:[function(t,e,n){const r=t("./cursor"),i=t("events"),o=t("./../lib/datastore");t("./../lib-extension/extendOriginalDatastore").extend(o);class a extends i{constructor(t){super(),Object.defineProperties(this,{__loaded:{enumerable:!1,writable:!0,value:null},__original:{configurable:!0,enumerable:!1,writable:!1,value:new o(t)}})}load(){return this.__loaded instanceof Promise||(this.__loaded=new Promise((t,e)=>{this.__original.loadDatabase(n=>{n?(this.emit("loadError",this,n),this.emit("__error__",this,"load",n),e(n)):(this.emit("load",this),t())})})),this.__loaded}find(t={},e){return"function"==typeof e&&(e={}),new r(this.__original.find(t,e),this.load(),(n,r)=>{n?(this.emit("findError",this,n,t,e),this.emit("__error__",this,"find",n,t,e)):this.emit("find",this,r,t,e)})}findOne(t={},e){return"function"==typeof e&&(e={}),new r(this.__original.findOne(t,e),this.load(),(n,r)=>{n?(this.emit("findOneError",this,n,t,e),this.emit("__error__",this,"findOne",n,t,e)):this.emit("findOne",this,r,t,e)})}insert(t){return this.load().then(()=>new Promise((e,n)=>{this.__original.insert(t,(r,i)=>{r?(this.emit("insertError",this,r,t),this.emit("__error__",this,"insert",r,t),n(r)):(this.emit("insert",this,i,t),e(i))})}))}update(t,e,n={}){return this.load().then(()=>new Promise((r,i)=>{this.__original.update(t,e,n,(o,a,u,s)=>{if(o)this.emit("updateError",this,o,t,e,n),this.emit("__error__",this,"update",o,t,e,n),i(o);else{let i={numAffected:a,affectedDocuments:u,upsert:s};this.emit("update",this,i,t,e,n),r(i)}})}))}remove(t={},e={}){return this.load().then(()=>new Promise((n,r)=>{this.__original.remove(t,e,(i,o)=>{i?(this.emit("removeError",this,i,t,e),this.emit("__error__",this,"remove",i,t,e),r(i)):(this.emit("remove",this,o,t,e),n(o))})}))}count(t={}){return new r(this.__original.count(t),this.load(),(e,n)=>{e?(this.emit("countError",this,e,t),this.emit("__error__",this,"count",e,t)):this.emit("count",this,n,t)})}ensureIndex(t){return new Promise((e,n)=>{this.__original.ensureIndex(t,r=>{r?(this.emit("ensureIndexError",this,r,t),this.emit("__error__",this,"ensureIndex",r,t),n(r)):(this.emit("ensureIndex",this,t),e())})})}removeIndex(t){return new Promise((e,n)=>{this.__original.removeIndex(t,r=>{r?(this.emit("removeIndexError",this,r,t),this.emit("__error__",this,"removeIndex",r,t),n(r)):(this.emit("removeIndex",this,t),e())})})}static create(t){return new Proxy(new this(t),{get:(t,e)=>t[e]?t[e]:t.__original[e],set:(t,e,n)=>t.__original.hasOwnProperty(e)?t.__original[e]=n:t[e]=n})}}t("./../lib-extension/extendPromiseDatastore").extend(a),e.exports=a},{"./../lib-extension/extendOriginalDatastore":9,"./../lib-extension/extendPromiseDatastore":11,"./../lib/datastore":19,"./cursor":12,events:1}],14:[function(t,e,n){var r=t("./bst"),i=t("./customUtils"),o=t("util");t("underscore");function a(t){this.tree=new u(t)}function u(t){t=t||{},this.left=null,this.right=null,this.parent=void 0!==t.parent?t.parent:null,t.hasOwnProperty("key")&&(this.key=t.key),this.data=t.hasOwnProperty("value")?[t.value]:[],this.unique=t.unique||!1,this.compareKeys=t.compareKeys||i.defaultCompareKeysFunction,this.checkValueEquality=t.checkValueEquality||i.defaultCheckValueEquality}o.inherits(u,r),a._AVLTree=u,u.prototype.checkHeightCorrect=function(){var t,e;if(this.hasOwnProperty("key")){if(this.left&&void 0===this.left.height)throw new Error("Undefined height for node "+this.left.key);if(this.right&&void 0===this.right.height)throw new Error("Undefined height for node "+this.right.key);if(void 0===this.height)throw new Error("Undefined height for node "+this.key);if(t=this.left?this.left.height:0,e=this.right?this.right.height:0,this.height!==1+Math.max(t,e))throw new Error("Height constraint failed for node "+this.key);this.left&&this.left.checkHeightCorrect(),this.right&&this.right.checkHeightCorrect()}},u.prototype.balanceFactor=function(){return(this.left?this.left.height:0)-(this.right?this.right.height:0)},u.prototype.checkBalanceFactors=function(){if(Math.abs(this.balanceFactor())>1)throw new Error("Tree is unbalanced at node "+this.key);this.left&&this.left.checkBalanceFactors(),this.right&&this.right.checkBalanceFactors()},u.prototype.checkIsAVLT=function(){u.super_.prototype.checkIsBST.call(this),this.checkHeightCorrect(),this.checkBalanceFactors()},a.prototype.checkIsAVLT=function(){this.tree.checkIsAVLT()},u.prototype.rightRotation=function(){var t,e,n,r,i=this,o=this.left;return o?(t=o.right,i.parent?(o.parent=i.parent,i.parent.left===i?i.parent.left=o:i.parent.right=o):o.parent=null,o.right=i,i.parent=o,i.left=t,t&&(t.parent=i),e=o.left?o.left.height:0,n=t?t.height:0,r=i.right?i.right.height:0,i.height=Math.max(n,r)+1,o.height=Math.max(e,i.height)+1,o):this},u.prototype.leftRotation=function(){var t,e,n,r,i=this,o=this.right;return o?(t=o.left,i.parent?(o.parent=i.parent,i.parent.left===i?i.parent.left=o:i.parent.right=o):o.parent=null,o.left=i,i.parent=o,i.right=t,t&&(t.parent=i),e=i.left?i.left.height:0,n=t?t.height:0,r=o.right?o.right.height:0,i.height=Math.max(e,n)+1,o.height=Math.max(r,i.height)+1,o):this},u.prototype.rightTooSmall=function(){return this.balanceFactor()<=1?this:(this.left.balanceFactor()<0&&this.left.leftRotation(),this.rightRotation())},u.prototype.leftTooSmall=function(){return this.balanceFactor()>=-1?this:(this.right.balanceFactor()>0&&this.right.rightRotation(),this.leftRotation())},u.prototype.rebalanceAlongPath=function(t){var e,n,r=this;if(!this.hasOwnProperty("key"))return delete this.height,this;for(n=t.length-1;n>=0;n-=1)t[n].height=1+Math.max(t[n].left?t[n].left.height:0,t[n].right?t[n].right.height:0),t[n].balanceFactor()>1&&(e=t[n].rightTooSmall(),0===n&&(r=e)),t[n].balanceFactor()<-1&&(e=t[n].leftTooSmall(),0===n&&(r=e));return r},u.prototype.insert=function(t,e){var n=[],r=this;if(!this.hasOwnProperty("key"))return this.key=t,this.data.push(e),this.height=1,this;for(;;){if(0===r.compareKeys(r.key,t)){if(r.unique){var i=new Error("Can't insert key "+t+", it violates the unique constraint");throw i.key=t,i.errorType="uniqueViolated",i}return r.data.push(e),this}if(n.push(r),r.compareKeys(t,r.key)<0){if(!r.left){n.push(r.createLeftChild({key:t,value:e}));break}r=r.left}else{if(!r.right){n.push(r.createRightChild({key:t,value:e}));break}r=r.right}}return this.rebalanceAlongPath(n)},a.prototype.insert=function(t,e){var n=this.tree.insert(t,e);n&&(this.tree=n)},u.prototype.delete=function(t,e){var n,r=[],i=this,o=[];if(!this.hasOwnProperty("key"))return this;for(;0!==i.compareKeys(t,i.key);)if(o.push(i),i.compareKeys(t,i.key)<0){if(!i.left)return this;i=i.left}else{if(!i.right)return this;i=i.right}if(i.data.length>1&&e)return i.data.forEach(function(t){i.checkValueEquality(t,e)||r.push(t)}),i.data=r,this;if(!i.left&&!i.right)return i===this?(delete i.key,i.data=[],delete i.height,this):(i.parent.left===i?i.parent.left=null:i.parent.right=null,this.rebalanceAlongPath(o));if(!i.left||!i.right)return n=i.left?i.left:i.right,i===this?(n.parent=null,n):(i.parent.left===i?(i.parent.left=n,n.parent=i.parent):(i.parent.right=n,n.parent=i.parent),this.rebalanceAlongPath(o));if(o.push(i),!(n=i.left).right)return i.key=n.key,i.data=n.data,i.left=n.left,n.left&&(n.left.parent=i),this.rebalanceAlongPath(o);for(;n.right;)o.push(n),n=n.right;return i.key=n.key,i.data=n.data,n.parent.right=n.left,n.left&&(n.left.parent=n.parent),this.rebalanceAlongPath(o)},a.prototype.delete=function(t,e){var n=this.tree.delete(t,e);n&&(this.tree=n)},["getNumberOfKeys","search","betweenBounds","prettyPrint","executeOnEveryNode"].forEach(function(t){a.prototype[t]=function(){return this.tree[t].apply(this.tree,arguments)}}),e.exports=a},{"./bst":15,"./customUtils":16,underscore:27,util:7}],15:[function(t,e,n){var r=t("./customUtils");function i(t){t=t||{},this.left=null,this.right=null,this.parent=void 0!==t.parent?t.parent:null,t.hasOwnProperty("key")&&(this.key=t.key),this.data=t.hasOwnProperty("value")?[t.value]:[],this.unique=t.unique||!1,this.compareKeys=t.compareKeys||r.defaultCompareKeysFunction,this.checkValueEquality=t.checkValueEquality||r.defaultCheckValueEquality}function o(t,e){var n;for(n=0;n<e.length;n+=1)t.push(e[n])}i.prototype.getMaxKeyDescendant=function(){return this.right?this.right.getMaxKeyDescendant():this},i.prototype.getMaxKey=function(){return this.getMaxKeyDescendant().key},i.prototype.getMinKeyDescendant=function(){return this.left?this.left.getMinKeyDescendant():this},i.prototype.getMinKey=function(){return this.getMinKeyDescendant().key},i.prototype.checkAllNodesFullfillCondition=function(t){this.hasOwnProperty("key")&&(t(this.key,this.data),this.left&&this.left.checkAllNodesFullfillCondition(t),this.right&&this.right.checkAllNodesFullfillCondition(t))},i.prototype.checkNodeOrdering=function(){var t=this;this.hasOwnProperty("key")&&(this.left&&(this.left.checkAllNodesFullfillCondition(function(e){if(t.compareKeys(e,t.key)>=0)throw new Error("Tree with root "+t.key+" is not a binary search tree")}),this.left.checkNodeOrdering()),this.right&&(this.right.checkAllNodesFullfillCondition(function(e){if(t.compareKeys(e,t.key)<=0)throw new Error("Tree with root "+t.key+" is not a binary search tree")}),this.right.checkNodeOrdering()))},i.prototype.checkInternalPointers=function(){if(this.left){if(this.left.parent!==this)throw new Error("Parent pointer broken for key "+this.key);this.left.checkInternalPointers()}if(this.right){if(this.right.parent!==this)throw new Error("Parent pointer broken for key "+this.key);this.right.checkInternalPointers()}},i.prototype.checkIsBST=function(){if(this.checkNodeOrdering(),this.checkInternalPointers(),this.parent)throw new Error("The root shouldn't have a parent")},i.prototype.getNumberOfKeys=function(){var t;return this.hasOwnProperty("key")?(t=1,this.left&&(t+=this.left.getNumberOfKeys()),this.right&&(t+=this.right.getNumberOfKeys()),t):0},i.prototype.createSimilar=function(t){return(t=t||{}).unique=this.unique,t.compareKeys=this.compareKeys,t.checkValueEquality=this.checkValueEquality,new this.constructor(t)},i.prototype.createLeftChild=function(t){var e=this.createSimilar(t);return e.parent=this,this.left=e,e},i.prototype.createRightChild=function(t){var e=this.createSimilar(t);return e.parent=this,this.right=e,e},i.prototype.insert=function(t,e){if(!this.hasOwnProperty("key"))return this.key=t,void this.data.push(e);if(0!==this.compareKeys(this.key,t))this.compareKeys(t,this.key)<0?this.left?this.left.insert(t,e):this.createLeftChild({key:t,value:e}):this.right?this.right.insert(t,e):this.createRightChild({key:t,value:e});else{if(this.unique){var n=new Error("Can't insert key "+t+", it violates the unique constraint");throw n.key=t,n.errorType="uniqueViolated",n}this.data.push(e)}},i.prototype.search=function(t){return this.hasOwnProperty("key")?0===this.compareKeys(this.key,t)?this.data:this.compareKeys(t,this.key)<0?this.left?this.left.search(t):[]:this.right?this.right.search(t):[]:[]},i.prototype.getLowerBoundMatcher=function(t){var e=this;return t.hasOwnProperty("$gt")||t.hasOwnProperty("$gte")?t.hasOwnProperty("$gt")&&t.hasOwnProperty("$gte")?0===e.compareKeys(t.$gte,t.$gt)?function(n){return e.compareKeys(n,t.$gt)>0}:e.compareKeys(t.$gte,t.$gt)>0?function(n){return e.compareKeys(n,t.$gte)>=0}:function(n){return e.compareKeys(n,t.$gt)>0}:t.hasOwnProperty("$gt")?function(n){return e.compareKeys(n,t.$gt)>0}:function(n){return e.compareKeys(n,t.$gte)>=0}:function(){return!0}},i.prototype.getUpperBoundMatcher=function(t){var e=this;return t.hasOwnProperty("$lt")||t.hasOwnProperty("$lte")?t.hasOwnProperty("$lt")&&t.hasOwnProperty("$lte")?0===e.compareKeys(t.$lte,t.$lt)?function(n){return e.compareKeys(n,t.$lt)<0}:e.compareKeys(t.$lte,t.$lt)<0?function(n){return e.compareKeys(n,t.$lte)<=0}:function(n){return e.compareKeys(n,t.$lt)<0}:t.hasOwnProperty("$lt")?function(n){return e.compareKeys(n,t.$lt)<0}:function(n){return e.compareKeys(n,t.$lte)<=0}:function(){return!0}},i.prototype.betweenBounds=function(t,e,n){var r=[];return this.hasOwnProperty("key")?(e=e||this.getLowerBoundMatcher(t),n=n||this.getUpperBoundMatcher(t),e(this.key)&&this.left&&o(r,this.left.betweenBounds(t,e,n)),e(this.key)&&n(this.key)&&o(r,this.data),n(this.key)&&this.right&&o(r,this.right.betweenBounds(t,e,n)),r):[]},i.prototype.deleteIfLeaf=function(){return!this.left&&!this.right&&(this.parent?(this.parent.left===this?this.parent.left=null:this.parent.right=null,!0):(delete this.key,this.data=[],!0))},i.prototype.deleteIfOnlyOneChild=function(){var t;return this.left&&!this.right&&(t=this.left),!this.left&&this.right&&(t=this.right),!!t&&(this.parent?(this.parent.left===this?(this.parent.left=t,t.parent=this.parent):(this.parent.right=t,t.parent=this.parent),!0):(this.key=t.key,this.data=t.data,this.left=null,t.left&&(this.left=t.left,t.left.parent=this),this.right=null,t.right&&(this.right=t.right,t.right.parent=this),!0))},i.prototype.delete=function(t,e){var n,r=[],i=this;if(this.hasOwnProperty("key"))if(this.compareKeys(t,this.key)<0)this.left&&this.left.delete(t,e);else if(this.compareKeys(t,this.key)>0)this.right&&this.right.delete(t,e);else if(0!==!this.compareKeys(t,this.key))return this.data.length>1&&void 0!==e?(this.data.forEach(function(t){i.checkValueEquality(t,e)||r.push(t)}),void(i.data=r)):void(this.deleteIfLeaf()||this.deleteIfOnlyOneChild()||(Math.random()>=.5?(n=this.left.getMaxKeyDescendant(),this.key=n.key,this.data=n.data,this===n.parent?(this.left=n.left,n.left&&(n.left.parent=n.parent)):(n.parent.right=n.left,n.left&&(n.left.parent=n.parent))):(n=this.right.getMinKeyDescendant(),this.key=n.key,this.data=n.data,this===n.parent?(this.right=n.right,n.right&&(n.right.parent=n.parent)):(n.parent.left=n.right,n.right&&(n.right.parent=n.parent)))))},i.prototype.executeOnEveryNode=function(t){this.left&&this.left.executeOnEveryNode(t),t(this),this.right&&this.right.executeOnEveryNode(t)},i.prototype.prettyPrint=function(t,e){e=e||"",console.log(e+"* "+this.key),t&&console.log(e+"* "+this.data),(this.left||this.right)&&(this.left?this.left.prettyPrint(t,e+"  "):console.log(e+"  *"),this.right?this.right.prettyPrint(t,e+"  "):console.log(e+"  *"))},e.exports=i},{"./customUtils":16}],16:[function(t,e,n){e.exports.getRandomArray=function t(e){var n,r;return 0===e?[]:1===e?[0]:(n=t(e-1),r=Math.floor(Math.random()*e),n.splice(r,0,e-1),n)},e.exports.defaultCompareKeysFunction=function(t,e){if(t<e)return-1;if(t>e)return 1;if(t===e)return 0;var n=new Error("Couldn't compare elements");throw n.a=t,n.b=e,n},e.exports.defaultCheckValueEquality=function(t,e){return t===e}},{}],17:[function(t,e,n){var r=t("./model"),i=t("underscore");function o(t,e,n){this.db=t,this.query=e||{},n&&(this.execFn=n)}o.prototype.limit=function(t){return this._limit=t,this},o.prototype.skip=function(t){return this._skip=t,this},o.prototype.sort=function(t){return this._sort=t,this},o.prototype.projection=function(t){return this._projection=t,this},o.prototype.project=function(t){var e,n,o,a=[],u=this;return void 0===this._projection||0===Object.keys(this._projection).length?t:(e=0!==this._projection._id,this._projection=i.omit(this._projection,"_id"),(o=Object.keys(this._projection)).forEach(function(t){if(void 0!==n&&u._projection[t]!==n)throw new Error("Can't both keep and omit fields except for _id");n=u._projection[t]}),t.forEach(function(t){var i;1===n?(i={$set:{}},o.forEach(function(e){i.$set[e]=r.getDotValue(t,e),void 0===i.$set[e]&&delete i.$set[e]}),i=r.modify({},i)):(i={$unset:{}},o.forEach(function(t){i.$unset[t]=!0}),i=r.modify(t,i)),e?i._id=t._id:delete i._id,a.push(i)}),a)},o.prototype._exec=function(t){var e,n,i,o=[],a=0,u=0,s=this,c=null;function f(e,n){return s.execFn?s.execFn(e,n,t):t(e,n)}this.db.getCandidates(this.query,function(t,l){if(t)return f(t);try{for(e=0;e<l.length;e+=1)if(r.match(l[e],s.query))if(s._sort)o.push(l[e]);else if(s._skip&&s._skip>u)u+=1;else if(o.push(l[e]),a+=1,s._limit&&s._limit<=a)break}catch(t){return f(t)}if(s._sort){n=Object.keys(s._sort);var h=[];for(e=0;e<n.length;e++)i=n[e],h.push({key:i,direction:s._sort[i]});o.sort(function(t,e){var n,i,o;for(o=0;o<h.length;o++)if(0!==(i=(n=h[o]).direction*r.compareThings(r.getDotValue(t,n.key),r.getDotValue(e,n.key),s.db.compareStrings)))return i;return 0});var p=s._limit||o.length,d=s._skip||0;o=o.slice(d,d+p)}try{o=s.project(o)}catch(t){c=t,o=void 0}return f(c,o)})},o.prototype.exec=function(){this.db.executor.push({this:this,fn:this._exec,arguments:arguments})},e.exports=o},{"./model":22,underscore:27}],18:[function(t,e,n){e.exports.uid=function(t){return function(t){var e,n,r,i,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=t.length%3,u="";for(r=0,n=t.length-a;r<n;r+=3)e=(t[r]<<16)+(t[r+1]<<8)+t[r+2],u+=o[(i=e)>>18&63]+o[i>>12&63]+o[i>>6&63]+o[63&i];switch(a){case 1:e=t[t.length-1],u+=o[e>>2],u+=o[e<<4&63],u+="==";break;case 2:e=(t[t.length-2]<<8)+t[t.length-1],u+=o[e>>10],u+=o[e>>4&63],u+=o[e<<2&63],u+="="}return u}(function(t){for(var e,n=new Array(t),r=0;r<t;r++)0==(3&r)&&(e=4294967296*Math.random()),n[r]=e>>>((3&r)<<3)&255;return n}(Math.ceil(Math.max(8,2*t)))).replace(/[+\/]/g,"").slice(0,t)}},{}],19:[function(t,e,n){var r=t("./customUtils"),i=t("./model"),o=t("async"),a=t("./executor"),u=t("./indexes"),s=t("util"),c=t("underscore"),f=t("./persistence"),l=t("./cursor");function h(t){var e;"string"==typeof t?(e=t,this.inMemoryOnly=!1):(e=(t=t||{}).filename,this.inMemoryOnly=t.inMemoryOnly||!1,this.autoload=t.autoload||!1,this.timestampData=t.timestampData||!1),e&&"string"==typeof e&&0!==e.length?this.filename=e:(this.filename=null,this.inMemoryOnly=!0),this.compareStrings=t.compareStrings,this.persistence=new f({db:this,nodeWebkitAppName:t.nodeWebkitAppName,afterSerialization:t.afterSerialization,beforeDeserialization:t.beforeDeserialization,corruptAlertThreshold:t.corruptAlertThreshold}),this.executor=new a,this.inMemoryOnly&&(this.executor.ready=!0),this.indexes={},this.indexes._id=new u({fieldName:"_id",unique:!0}),this.ttlIndexes={},this.autoload&&this.loadDatabase(t.onload||function(t){if(t)throw t})}s.inherits(h,t("events").EventEmitter),h.prototype.loadDatabase=function(){this.executor.push({this:this.persistence,fn:this.persistence.loadDatabase,arguments:arguments},!0)},h.prototype.getAllData=function(){return this.indexes._id.getAll()},h.prototype.resetIndexes=function(t){var e=this;Object.keys(this.indexes).forEach(function(n){e.indexes[n].reset(t)})},h.prototype.ensureIndex=function(t,e){var n,r=e||function(){};if(!(t=t||{}).fieldName)return(n=new Error("Cannot create an index without a fieldName")).missingFieldName=!0,r(n);if(this.indexes[t.fieldName])return r(null);this.indexes[t.fieldName]=new u(t),void 0!==t.expireAfterSeconds&&(this.ttlIndexes[t.fieldName]=t.expireAfterSeconds);try{this.indexes[t.fieldName].insert(this.getAllData())}catch(e){return delete this.indexes[t.fieldName],r(e)}this.persistence.persistNewState([{$$indexCreated:t}],function(t){return r(t||null)})},h.prototype.removeIndex=function(t,e){var n=e||function(){};delete this.indexes[t],this.persistence.persistNewState([{$$indexRemoved:t}],function(t){return n(t||null)})},h.prototype.addToIndexes=function(t){var e,n,r,i=Object.keys(this.indexes);for(e=0;e<i.length;e+=1)try{this.indexes[i[e]].insert(t)}catch(t){n=e,r=t;break}if(r){for(e=0;e<n;e+=1)this.indexes[i[e]].remove(t);throw r}},h.prototype.removeFromIndexes=function(t){var e=this;Object.keys(this.indexes).forEach(function(n){e.indexes[n].remove(t)})},h.prototype.updateIndexes=function(t,e){var n,r,i,o=Object.keys(this.indexes);for(n=0;n<o.length;n+=1)try{this.indexes[o[n]].update(t,e)}catch(t){r=n,i=t;break}if(i){for(n=0;n<r;n+=1)this.indexes[o[n]].revertUpdate(t,e);throw i}},h.prototype.getCandidates=function(t,e,n){var r,i=Object.keys(this.indexes),a=this;"function"==typeof e&&(n=e,e=!1),o.waterfall([function(e){return r=[],Object.keys(t).forEach(function(e){("string"==typeof t[e]||"number"==typeof t[e]||"boolean"==typeof t[e]||s.isDate(t[e])||null===t[e])&&r.push(e)}),(r=c.intersection(r,i)).length>0?e(null,a.indexes[r[0]].getMatching(t[r[0]])):(r=[],Object.keys(t).forEach(function(e){t[e]&&t[e].hasOwnProperty("$in")&&r.push(e)}),(r=c.intersection(r,i)).length>0?e(null,a.indexes[r[0]].getMatching(t[r[0]].$in)):(r=[],Object.keys(t).forEach(function(e){t[e]&&(t[e].hasOwnProperty("$lt")||t[e].hasOwnProperty("$lte")||t[e].hasOwnProperty("$gt")||t[e].hasOwnProperty("$gte"))&&r.push(e)}),(r=c.intersection(r,i)).length>0?e(null,a.indexes[r[0]].getBetweenBounds(t[r[0]])):e(null,a.getAllData())))},function(t){if(e)return n(null,t);var r=[],i=[],u=Object.keys(a.ttlIndexes);t.forEach(function(t){var e=!0;u.forEach(function(n){void 0!==t[n]&&s.isDate(t[n])&&Date.now()>t[n].getTime()+1e3*a.ttlIndexes[n]&&(e=!1)}),e?i.push(t):r.push(t._id)}),o.eachSeries(r,function(t,e){a._remove({_id:t},{},function(t){return t?n(t):e()})},function(t){return n(null,i)})}])},h.prototype._insert=function(t,e){var n,r=e||function(){};try{n=this.prepareDocumentForInsertion(t),this._insertInCache(n)}catch(t){return r(t)}this.persistence.persistNewState(s.isArray(n)?n:[n],function(t){return t?r(t):r(null,i.deepCopy(n))})},h.prototype.createNewId=function(){var t=r.uid(16);return this.indexes._id.getMatching(t).length>0&&(t=this.createNewId()),t},h.prototype.prepareDocumentForInsertion=function(t){var e,n=this;if(s.isArray(t))e=[],t.forEach(function(t){e.push(n.prepareDocumentForInsertion(t))});else{void 0===(e=i.deepCopy(t))._id&&(e._id=this.createNewId());var r=new Date;this.timestampData&&void 0===e.createdAt&&(e.createdAt=r),this.timestampData&&void 0===e.updatedAt&&(e.updatedAt=r),i.checkObject(e)}return e},h.prototype._insertInCache=function(t){s.isArray(t)?this._insertMultipleDocsInCache(t):this.addToIndexes(t)},h.prototype._insertMultipleDocsInCache=function(t){var e,n,r;for(e=0;e<t.length;e+=1)try{this.addToIndexes(t[e])}catch(t){r=t,n=e;break}if(r){for(e=0;e<n;e+=1)this.removeFromIndexes(t[e]);throw r}},h.prototype.insert=function(){this.executor.push({this:this,fn:this._insert,arguments:arguments})},h.prototype.count=function(t,e){var n=new l(this,t,function(t,e,n){return t?n(t):n(null,e.length)});if("function"!=typeof e)return n;n.exec(e)},h.prototype.find=function(t,e,n){switch(arguments.length){case 1:e={};break;case 2:"function"==typeof e&&(n=e,e={})}var r=new l(this,t,function(t,e,n){var r,o=[];if(t)return n(t);for(r=0;r<e.length;r+=1)o.push(i.deepCopy(e[r]));return n(null,o)});if(r.projection(e),"function"!=typeof n)return r;r.exec(n)},h.prototype.findOne=function(t,e,n){switch(arguments.length){case 1:e={};break;case 2:"function"==typeof e&&(n=e,e={})}var r=new l(this,t,function(t,e,n){return t?n(t):1===e.length?n(null,i.deepCopy(e[0])):n(null,null)});if(r.projection(e).limit(1),"function"!=typeof n)return r;r.exec(n)},h.prototype._update=function(t,e,n,r){var a,u,s,f,h=this,p=0;"function"==typeof n&&(r=n,n={}),a=r||function(){},u=void 0!==n.multi&&n.multi,s=void 0!==n.upsert&&n.upsert,o.waterfall([function(n){if(!s)return n();new l(h,t).limit(1)._exec(function(r,o){if(r)return a(r);if(1===o.length)return n();var u;try{i.checkObject(e),u=e}catch(n){try{u=i.modify(i.deepCopy(t,!0),e)}catch(r){return a(r)}}return h._insert(u,function(t,e){return t?a(t):a(null,1,e,!0)})})},function(){var r,o,s=[];h.getCandidates(t,function(l,d){if(l)return a(l);try{for(f=0;f<d.length;f+=1)i.match(d[f],t)&&(u||0===p)&&(p+=1,h.timestampData&&(o=d[f].createdAt),r=i.modify(d[f],e),h.timestampData&&(r.createdAt=o,r.updatedAt=new Date),s.push({oldDoc:d[f],newDoc:r}))}catch(l){return a(l)}try{h.updateIndexes(s)}catch(l){return a(l)}var y=c.pluck(s,"newDoc");h.persistence.persistNewState(y,function(t){if(t)return a(t);if(n.returnUpdatedDocs){var e=[];return y.forEach(function(t){e.push(i.deepCopy(t))}),u||(e=e[0]),a(null,p,e)}return a(null,p)})})}])},h.prototype.update=function(){this.executor.push({this:this,fn:this._update,arguments:arguments})},h.prototype._remove=function(t,e,n){var r,o,a=this,u=0,s=[];"function"==typeof e&&(n=e,e={}),r=n||function(){},o=void 0!==e.multi&&e.multi,this.getCandidates(t,!0,function(e,n){if(e)return r(e);try{n.forEach(function(e){i.match(e,t)&&(o||0===u)&&(u+=1,s.push({$$deleted:!0,_id:e._id}),a.removeFromIndexes(e))})}catch(e){return r(e)}a.persistence.persistNewState(s,function(t){return t?r(t):r(null,u)})})},h.prototype.remove=function(){this.executor.push({this:this,fn:this._remove,arguments:arguments})},e.exports=h},{"./cursor":17,"./customUtils":18,"./executor":20,"./indexes":21,"./model":22,"./persistence":23,async:25,events:1,underscore:27,util:7}],20:[function(t,e,n){(function(n,r){var i=t("async");function o(){this.buffer=[],this.ready=!1,this.queue=i.queue(function(t,e){for(var i=[],o=0;o<t.arguments.length;o+=1)i.push(t.arguments[o]);var a=t.arguments[t.arguments.length-1];"function"==typeof a?i[i.length-1]=function(){"function"==typeof r?r(e):n.nextTick(e),a.apply(null,arguments)}:a||0===t.arguments.length?i.push(function(){e()}):i[i.length-1]=function(){e()},t.fn.apply(t.this,i)},1)}o.prototype.push=function(t,e){this.ready||e?this.queue.push(t):this.buffer.push(t)},o.prototype.processBuffer=function(){var t;for(this.ready=!0,t=0;t<this.buffer.length;t+=1)this.queue.push(this.buffer[t]);this.buffer=[]},e.exports=o}).call(this,t("_process"),t("timers").setImmediate)},{_process:3,async:25,timers:4}],21:[function(t,e,n){var r=t("./binary-search-tree/lib/avltree"),i=t("./model"),o=t("underscore"),a=t("util");function u(t,e){return t===e}function s(t){return null===t?"$null":"string"==typeof t?"$string"+t:"boolean"==typeof t?"$boolean"+t:"number"==typeof t?"$number"+t:a.isArray(t)?"$date"+t.getTime():t}function c(t){this.fieldName=t.fieldName,this.unique=t.unique||!1,this.sparse=t.sparse||!1,this.treeOptions={unique:this.unique,compareKeys:i.compareThings,checkValueEquality:u},this.reset()}c.prototype.reset=function(t){this.tree=new r(this.treeOptions),t&&this.insert(t)},c.prototype.insert=function(t){var e,n,r,u,c;if(a.isArray(t))this.insertMultipleDocs(t);else if(void 0!==(e=i.getDotValue(t,this.fieldName))||!this.sparse)if(a.isArray(e)){for(n=o.uniq(e,s),r=0;r<n.length;r+=1)try{this.tree.insert(n[r],t)}catch(t){c=t,u=r;break}if(c){for(r=0;r<u;r+=1)this.tree.delete(n[r],t);throw c}}else this.tree.insert(e,t)},c.prototype.insertMultipleDocs=function(t){var e,n,r;for(e=0;e<t.length;e+=1)try{this.insert(t[e])}catch(t){n=t,r=e;break}if(n){for(e=0;e<r;e+=1)this.remove(t[e]);throw n}},c.prototype.remove=function(t){var e,n=this;a.isArray(t)?t.forEach(function(t){n.remove(t)}):void 0===(e=i.getDotValue(t,this.fieldName))&&this.sparse||(a.isArray(e)?o.uniq(e,s).forEach(function(e){n.tree.delete(e,t)}):this.tree.delete(e,t))},c.prototype.update=function(t,e){if(a.isArray(t))this.updateMultipleDocs(t);else{this.remove(t);try{this.insert(e)}catch(e){throw this.insert(t),e}}},c.prototype.updateMultipleDocs=function(t){var e,n,r;for(e=0;e<t.length;e+=1)this.remove(t[e].oldDoc);for(e=0;e<t.length;e+=1)try{this.insert(t[e].newDoc)}catch(t){r=t,n=e;break}if(r){for(e=0;e<n;e+=1)this.remove(t[e].newDoc);for(e=0;e<t.length;e+=1)this.insert(t[e].oldDoc);throw r}},c.prototype.revertUpdate=function(t,e){var n=[];a.isArray(t)?(t.forEach(function(t){n.push({oldDoc:t.newDoc,newDoc:t.oldDoc})}),this.update(n)):this.update(e,t)},c.prototype.getMatching=function(t){var e=this;if(a.isArray(t)){var n={},r=[];return t.forEach(function(t){e.getMatching(t).forEach(function(t){n[t._id]=t})}),Object.keys(n).forEach(function(t){r.push(n[t])}),r}return e.tree.search(t)},c.prototype.getBetweenBounds=function(t){return this.tree.betweenBounds(t)},c.prototype.getAll=function(){var t=[];return this.tree.executeOnEveryNode(function(e){var n;for(n=0;n<e.data.length;n+=1)t.push(e.data[n])}),t},e.exports=c},{"./binary-search-tree/lib/avltree":14,"./model":22,underscore:27,util:7}],22:[function(t,e,n){var r=t("util"),i=t("underscore"),o={},a={},u={},s={},c={};function f(t,e){if("number"==typeof t&&(t=t.toString()),!("$"!==t[0]||"$$date"===t&&"number"==typeof e||"$$deleted"===t&&!0===e||"$$indexCreated"===t||"$$indexRemoved"===t))throw new Error("Field names cannot begin with the $ character");if(-1!==t.indexOf("."))throw new Error("Field names cannot contain a .")}function l(t){r.isArray(t)&&t.forEach(function(t){l(t)}),"object"==typeof t&&null!==t&&Object.keys(t).forEach(function(e){f(e,t[e]),l(t[e])})}function h(t,e){var n;return"boolean"==typeof t||"number"==typeof t||"string"==typeof t||null===t||r.isDate(t)?t:r.isArray(t)?(n=[],t.forEach(function(t){n.push(h(t,e))}),n):"object"==typeof t?(n={},Object.keys(t).forEach(function(r){(!e||"$"!==r[0]&&-1===r.indexOf("."))&&(n[r]=h(t[r],e))}),n):void 0}function p(t){return"boolean"==typeof t||"number"==typeof t||"string"==typeof t||null===t||r.isDate(t)||r.isArray(t)}function d(t,e){return t<e?-1:t>e?1:0}function y(t,e){var n,r;for(n=0;n<Math.min(t.length,e.length);n+=1)if(0!==(r=v(t[n],e[n])))return r;return d(t.length,e.length)}function v(t,e,n){var i,o,a,u,s=n||d;if(void 0===t)return void 0===e?0:-1;if(void 0===e)return void 0===t?0:1;if(null===t)return null===e?0:-1;if(null===e)return null===t?0:1;if("number"==typeof t)return"number"==typeof e?d(t,e):-1;if("number"==typeof e)return"number"==typeof t?d(t,e):1;if("string"==typeof t)return"string"==typeof e?s(t,e):-1;if("string"==typeof e)return"string"==typeof t?s(t,e):1;if("boolean"==typeof t)return"boolean"==typeof e?d(t,e):-1;if("boolean"==typeof e)return"boolean"==typeof t?d(t,e):1;if(r.isDate(t))return r.isDate(e)?d(t.getTime(),e.getTime()):-1;if(r.isDate(e))return r.isDate(t)?d(t.getTime(),e.getTime()):1;if(r.isArray(t))return r.isArray(e)?y(t,e):-1;if(r.isArray(e))return r.isArray(t)?y(t,e):1;for(i=Object.keys(t).sort(),o=Object.keys(e).sort(),u=0;u<Math.min(i.length,o.length);u+=1)if(0!==(a=v(t[i[u]],e[o[u]])))return a;return d(i.length,o.length)}function g(t,e){var n,i,o="string"==typeof e?e.split("."):e;if(t){if(0===o.length)return t;if(1===o.length)return t[o[0]];if(r.isArray(t[o[0]])){if("number"==typeof(n=parseInt(o[1],10))&&!isNaN(n))return g(t[o[0]][n],o.slice(2));for(i=new Array,n=0;n<t[o[0]].length;n+=1)i.push(g(t[o[0]][n],o.slice(1)));return i}return g(t[o[0]],o.slice(1))}}function m(t,e){var n,i,o;if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e)return t===e;if(r.isDate(t)||r.isDate(e))return r.isDate(t)&&r.isDate(e)&&t.getTime()===e.getTime();if((!r.isArray(t)||!r.isArray(e))&&(r.isArray(t)||r.isArray(e))||void 0===t||void 0===e)return!1;try{n=Object.keys(t),i=Object.keys(e)}catch(t){return!1}if(n.length!==i.length)return!1;for(o=0;o<n.length;o+=1){if(-1===i.indexOf(n[o]))return!1;if(!m(t[n[o]],e[n[o]]))return!1}return!0}function _(t,e){return!("string"!=typeof t&&"number"!=typeof t&&!r.isDate(t)&&"string"!=typeof e&&"number"!=typeof e&&!r.isDate(e))&&typeof t==typeof e}function b(t,e){var n,r,i,o;if(p(t)||p(e))return w({needAKey:t},"needAKey",e);for(n=Object.keys(e),o=0;o<n.length;o+=1)if(i=e[r=n[o]],"$"===r[0]){if(!s[r])throw new Error("Unknown logical operator "+r);if(!s[r](t,i))return!1}else if(!w(t,r,i))return!1;return!0}function w(t,e,n,o){var a,s,f,l,h=g(t,e);if(r.isArray(h)&&!o){if(r.isArray(n))return w(t,e,n,!0);if(null!==n&&"object"==typeof n&&!r.isRegExp(n))for(s=Object.keys(n),a=0;a<s.length;a+=1)if(c[s[a]])return w(t,e,n,!0);for(a=0;a<h.length;a+=1)if(w({k:h[a]},"k",n))return!0;return!1}if(null!==n&&"object"==typeof n&&!r.isRegExp(n)&&!r.isArray(n)){if(s=Object.keys(n),f=i.map(s,function(t){return t[0]}),0!==(l=i.filter(f,function(t){return"$"===t})).length&&l.length!==f.length)throw new Error("You cannot mix operators and normal fields");if(l.length>0){for(a=0;a<s.length;a+=1){if(!u[s[a]])throw new Error("Unknown comparison function "+s[a]);if(!u[s[a]](h,n[s[a]]))return!1}return!0}}return r.isRegExp(n)?u.$regex(h,n):!!m(h,n)}a.$set=function(t,e,n){t[e]=n},a.$unset=function(t,e,n){delete t[e]},a.$push=function(t,e,n){if(t.hasOwnProperty(e)||(t[e]=[]),!r.isArray(t[e]))throw new Error("Can't $push an element on non-array values");if(null!==n&&"object"==typeof n&&n.$slice&&void 0===n.$each&&(n.$each=[]),null!==n&&"object"==typeof n&&n.$each){if(Object.keys(n).length>=3||2===Object.keys(n).length&&void 0===n.$slice)throw new Error("Can only use $slice in cunjunction with $each when $push to array");if(!r.isArray(n.$each))throw new Error("$each requires an array value");if(n.$each.forEach(function(n){t[e].push(n)}),void 0===n.$slice||"number"!=typeof n.$slice)return;if(0===n.$slice)t[e]=[];else{var i,o,a=t[e].length;n.$slice<0?(i=Math.max(0,a+n.$slice),o=a):n.$slice>0&&(i=0,o=Math.min(a,n.$slice)),t[e]=t[e].slice(i,o)}}else t[e].push(n)},a.$addToSet=function(t,e,n){var i=!0;if(t.hasOwnProperty(e)||(t[e]=[]),!r.isArray(t[e]))throw new Error("Can't $addToSet an element on non-array values");if(null!==n&&"object"==typeof n&&n.$each){if(Object.keys(n).length>1)throw new Error("Can't use another field in conjunction with $each");if(!r.isArray(n.$each))throw new Error("$each requires an array value");n.$each.forEach(function(n){a.$addToSet(t,e,n)})}else t[e].forEach(function(t){0===v(t,n)&&(i=!1)}),i&&t[e].push(n)},a.$pop=function(t,e,n){if(!r.isArray(t[e]))throw new Error("Can't $pop an element from non-array values");if("number"!=typeof n)throw new Error(n+" isn't an integer, can't use it with $pop");0!==n&&(t[e]=n>0?t[e].slice(0,t[e].length-1):t[e].slice(1))},a.$pull=function(t,e,n){var i,o;if(!r.isArray(t[e]))throw new Error("Can't $pull an element from non-array values");for(o=(i=t[e]).length-1;o>=0;o-=1)b(i[o],n)&&i.splice(o,1)},a.$inc=function(t,e,n){if("number"!=typeof n)throw new Error(n+" must be a number");if("number"!=typeof t[e]){if(i.has(t,e))throw new Error("Don't use the $inc modifier on non-number fields");t[e]=n}else t[e]+=n},a.$max=function(t,e,n){void 0===t[e]?t[e]=n:n>t[e]&&(t[e]=n)},a.$min=function(t,e,n){void 0===t[e]?t[e]=n:n<t[e]&&(t[e]=n)},Object.keys(a).forEach(function(t){o[t]=function(t){return function(e,n,r){var i="string"==typeof n?n.split("."):n;if(1===i.length)a[t](e,n,r);else{if(void 0===e[i[0]]){if("$unset"===t)return;e[i[0]]={}}o[t](e[i[0]],i.slice(1),r)}}}(t)}),u.$lt=function(t,e){return _(t,e)&&t<e},u.$lte=function(t,e){return _(t,e)&&t<=e},u.$gt=function(t,e){return _(t,e)&&t>e},u.$gte=function(t,e){return _(t,e)&&t>=e},u.$ne=function(t,e){return void 0===t||!m(t,e)},u.$in=function(t,e){var n;if(!r.isArray(e))throw new Error("$in operator called with a non-array");for(n=0;n<e.length;n+=1)if(m(t,e[n]))return!0;return!1},u.$nin=function(t,e){if(!r.isArray(e))throw new Error("$nin operator called with a non-array");return!u.$in(t,e)},u.$regex=function(t,e){if(!r.isRegExp(e))throw new Error("$regex operator called with non regular expression");return"string"==typeof t&&e.test(t)},u.$exists=function(t,e){return e=!(!e&&""!==e),void 0===t?!e:e},u.$size=function(t,e){if(!r.isArray(t))return!1;if(e%1!=0)throw new Error("$size operator called without an integer");return t.length==e},u.$elemMatch=function(t,e){if(!r.isArray(t))return!1;for(var n=t.length,i=!1;n--;)if(b(t[n],e)){i=!0;break}return i},c.$size=!0,c.$elemMatch=!0,s.$or=function(t,e){var n;if(!r.isArray(e))throw new Error("$or operator used without an array");for(n=0;n<e.length;n+=1)if(b(t,e[n]))return!0;return!1},s.$and=function(t,e){var n;if(!r.isArray(e))throw new Error("$and operator used without an array");for(n=0;n<e.length;n+=1)if(!b(t,e[n]))return!1;return!0},s.$not=function(t,e){return!b(t,e)},s.$where=function(t,e){var n;if(!i.isFunction(e))throw new Error("$where operator used without a function");if(n=e.call(t),!i.isBoolean(n))throw new Error("$where function must return boolean");return n},e.exports.serialize=function(t){return JSON.stringify(t,function(t,e){if(f(t,e),void 0!==e)return null===e?null:"function"==typeof this[t].getTime?{$$date:this[t].getTime()}:e})},e.exports.deserialize=function(t){return JSON.parse(t,function(t,e){return"$$date"===t?new Date(e):"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e?e:e&&e.$$date?e.$$date:e})},e.exports.deepCopy=h,e.exports.checkObject=l,e.exports.isPrimitiveType=p,e.exports.modify=function(t,e){var n,r,a=Object.keys(e),u=i.map(a,function(t){return t[0]}),s=i.filter(u,function(t){return"$"===t});if(-1!==a.indexOf("_id")&&e._id!==t._id)throw new Error("You cannot change a document's _id");if(0!==s.length&&s.length!==u.length)throw new Error("You cannot mix modifiers and normal fields");if(0===s.length?(n=h(e))._id=t._id:(r=i.uniq(a),n=h(t),r.forEach(function(t){if(!o[t])throw new Error("Unknown modifier "+t);if("object"!=typeof e[t])throw new Error("Modifier "+t+"'s argument must be an object");Object.keys(e[t]).forEach(function(r){o[t](n,r,e[t][r])})})),l(n),t._id!==n._id)throw new Error("You can't change a document's _id");return n},e.exports.getDotValue=g,e.exports.match=b,e.exports.areThingsEqual=m,e.exports.compareThings=v},{underscore:27,util:7}],23:[function(t,e,n){(function(n){var r=t("./storage"),i=t("path"),o=t("./model"),a=t("async"),u=t("./customUtils"),s=t("./indexes");function c(t){var e,n,r;if(this.db=t.db,this.inMemoryOnly=this.db.inMemoryOnly,this.filename=this.db.filename,this.corruptAlertThreshold=void 0!==t.corruptAlertThreshold?t.corruptAlertThreshold:.1,!this.inMemoryOnly&&this.filename&&"~"===this.filename.charAt(this.filename.length-1))throw new Error("The datafile name can't end with a ~, which is reserved for crash safe backup files");if(t.afterSerialization&&!t.beforeDeserialization)throw new Error("Serialization hook defined but deserialization hook undefined, cautiously refusing to start NeDB to prevent dataloss");if(!t.afterSerialization&&t.beforeDeserialization)throw new Error("Serialization hook undefined but deserialization hook defined, cautiously refusing to start NeDB to prevent dataloss");for(this.afterSerialization=t.afterSerialization||function(t){return t},this.beforeDeserialization=t.beforeDeserialization||function(t){return t},e=1;e<30;e+=1)for(n=0;n<10;n+=1)if(r=u.uid(e),this.beforeDeserialization(this.afterSerialization(r))!==r)throw new Error("beforeDeserialization is not the reverse of afterSerialization, cautiously refusing to start NeDB to prevent dataloss");this.filename&&t.nodeWebkitAppName&&(console.log("=================================================================="),console.log("WARNING: The nodeWebkitAppName option is deprecated"),console.log("To get the path to the directory where Node Webkit stores the data"),console.log("for your app, use the internal nw.gui module like this"),console.log("require('nw.gui').App.dataPath"),console.log("See https://github.com/rogerwang/node-webkit/issues/500"),console.log("=================================================================="),this.filename=c.getNWAppFilename(t.nodeWebkitAppName,this.filename))}c.ensureDirectoryExists=function(t,e){var n=e||function(){};r.mkdirp(t,function(t){return n(t)})},c.getNWAppFilename=function(t,e){var r;switch(n.platform){case"win32":case"win64":if(!(r=n.env.LOCALAPPDATA||n.env.APPDATA))throw new Error("Couldn't find the base application data folder");r=i.join(r,t);break;case"darwin":if(!(r=n.env.HOME))throw new Error("Couldn't find the base application data directory");r=i.join(r,"Library","Application Support",t);break;case"linux":if(!(r=n.env.HOME))throw new Error("Couldn't find the base application data directory");r=i.join(r,".config",t);break;default:throw new Error("Can't use the Node Webkit relative path for platform "+n.platform)}return i.join(r,"nedb-data",e)},c.prototype.persistCachedDatabase=function(t){var e=t||function(){},n="",i=this;if(this.inMemoryOnly)return e(null);this.db.getAllData().forEach(function(t){n+=i.afterSerialization(o.serialize(t))+"\n"}),Object.keys(this.db.indexes).forEach(function(t){"_id"!=t&&(n+=i.afterSerialization(o.serialize({$$indexCreated:{fieldName:t,unique:i.db.indexes[t].unique,sparse:i.db.indexes[t].sparse}}))+"\n")}),r.crashSafeWriteFile(this.filename,n,function(t){return t?e(t):(i.db.emit("compaction.done"),e(null))})},c.prototype.compactDatafile=function(){this.db.executor.push({this:this,fn:this.persistCachedDatabase,arguments:[]})},c.prototype.setAutocompactionInterval=function(t){var e=this,n=Math.max(t||0,5e3);this.stopAutocompaction(),this.autocompactionIntervalId=setInterval(function(){e.compactDatafile()},n)},c.prototype.stopAutocompaction=function(){this.autocompactionIntervalId&&clearInterval(this.autocompactionIntervalId)},c.prototype.persistNewState=function(t,e){var n=this,i="",a=e||function(){};return n.inMemoryOnly?a(null):(t.forEach(function(t){i+=n.afterSerialization(o.serialize(t))+"\n"}),0===i.length?a(null):void r.appendFile(n.filename,i,"utf8",function(t){return a(t)}))},c.prototype.treatRawData=function(t){var e,n=t.split("\n"),r={},i=[],a={},u=-1;for(e=0;e<n.length;e+=1){var s;try{(s=o.deserialize(this.beforeDeserialization(n[e])))._id?!0===s.$$deleted?delete r[s._id]:r[s._id]=s:s.$$indexCreated&&void 0!=s.$$indexCreated.fieldName?a[s.$$indexCreated.fieldName]=s.$$indexCreated:"string"==typeof s.$$indexRemoved&&delete a[s.$$indexRemoved]}catch(t){u+=1}}if(n.length>0&&u/n.length>this.corruptAlertThreshold)throw new Error("More than "+Math.floor(100*this.corruptAlertThreshold)+"% of the data file is corrupt, the wrong beforeDeserialization hook may be used. Cautiously refusing to start NeDB to prevent dataloss");return Object.keys(r).forEach(function(t){i.push(r[t])}),{data:i,indexes:a}},c.prototype.loadDatabase=function(t){var e=t||function(){},n=this;if(n.db.resetIndexes(),n.inMemoryOnly)return e(null);a.waterfall([function(t){c.ensureDirectoryExists(i.dirname(n.filename),function(e){r.ensureDatafileIntegrity(n.filename,function(e){r.readFile(n.filename,"utf8",function(e,r){if(e)return t(e);try{var i=n.treatRawData(r)}catch(e){return t(e)}Object.keys(i.indexes).forEach(function(t){n.db.indexes[t]=new s(i.indexes[t])});try{n.db.resetIndexes(i.data)}catch(e){return n.db.resetIndexes(),t(e)}n.db.persistence.persistCachedDatabase(t)})})})}],function(t){return t?e(t):(n.db.executor.processBuffer(),e(null))})},e.exports=c}).call(this,t("_process"))},{"./customUtils":18,"./indexes":21,"./model":22,"./storage":24,_process:3,async:25,path:2}],24:[function(t,e,n){var r=t("localforage");function i(t,e,n,i){"function"==typeof n&&(i=n),r.setItem(t,e,function(){return i()})}r.config({name:"NeDB",storeName:"nedbdata"}),e.exports.exists=function(t,e){r.getItem(t,function(t,n){return e(null!==n)})},e.exports.rename=function(t,e,n){r.getItem(t,function(i,o){null===o?r.removeItem(e,function(){return n()}):r.setItem(e,o,function(){r.removeItem(t,function(){return n()})})})},e.exports.writeFile=i,e.exports.crashSafeWriteFile=i,e.exports.appendFile=function(t,e,n,i){"function"==typeof n&&(i=n),r.getItem(t,function(n,o){o=o||"",o+=e,r.setItem(t,o,function(){return i()})})},e.exports.readFile=function(t,e,n){"function"==typeof e&&(n=e),r.getItem(t,function(t,e){return n(null,e||"")})},e.exports.unlink=function(t,e){r.removeItem(t,function(){return e()})},e.exports.mkdirp=function(t,e){return e()},e.exports.ensureDatafileIntegrity=function(t,e){return e(null)}},{localforage:26}],25:[function(t,e,n){(function(t,n){!function(){var r,i,o={};function a(t){var e=!1;return function(){if(e)throw new Error("Callback was already called.");e=!0,t.apply(r,arguments)}}null!=(r=this)&&(i=r.async),o.noConflict=function(){return r.async=i,o};var u=function(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n+=1)e(t[n],n,t)},s=function(t,e){if(t.map)return t.map(e);var n=[];return u(t,function(t,r,i){n.push(e(t,r,i))}),n},c=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e};void 0!==t&&t.nextTick?(o.nextTick=t.nextTick,o.setImmediate=void 0!==n?function(t){n(t)}:o.nextTick):"function"==typeof n?(o.nextTick=function(t){n(t)},o.setImmediate=o.nextTick):(o.nextTick=function(t){setTimeout(t,0)},o.setImmediate=o.nextTick),o.each=function(t,e,n){if(n=n||function(){},!t.length)return n();var r=0;u(t,function(i){e(i,a(function(e){e?(n(e),n=function(){}):(r+=1)>=t.length&&n(null)}))})},o.forEach=o.each,o.eachSeries=function(t,e,n){if(n=n||function(){},!t.length)return n();var r=0,i=function(){e(t[r],function(e){e?(n(e),n=function(){}):(r+=1)>=t.length?n(null):i()})};i()},o.forEachSeries=o.eachSeries,o.eachLimit=function(t,e,n,r){f(e).apply(null,[t,n,r])},o.forEachLimit=o.eachLimit;var f=function(t){return function(e,n,r){if(r=r||function(){},!e.length||t<=0)return r();var i=0,o=0,a=0;!function u(){if(i>=e.length)return r();for(;a<t&&o<e.length;)a+=1,n(e[(o+=1)-1],function(t){t?(r(t),r=function(){}):(a-=1,(i+=1)>=e.length?r():u())})}()}},l=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[o.each].concat(e))}},h=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[o.eachSeries].concat(e))}},p=function(t,e,n,r){var i=[];t(e=s(e,function(t,e){return{index:e,value:t}}),function(t,e){n(t.value,function(n,r){i[t.index]=r,e(n)})},function(t){r(t,i)})};o.map=l(p),o.mapSeries=h(p),o.mapLimit=function(t,e,n,r){return d(e)(t,n,r)};var d=function(t){return function(t,e){return function(){var n=Array.prototype.slice.call(arguments);return e.apply(null,[f(t)].concat(n))}}(t,p)};o.reduce=function(t,e,n,r){o.eachSeries(t,function(t,r){n(e,t,function(t,n){e=n,r(t)})},function(t){r(t,e)})},o.inject=o.reduce,o.foldl=o.reduce,o.reduceRight=function(t,e,n,r){var i=s(t,function(t){return t}).reverse();o.reduce(i,e,n,r)},o.foldr=o.reduceRight;var y=function(t,e,n,r){var i=[];t(e=s(e,function(t,e){return{index:e,value:t}}),function(t,e){n(t.value,function(n){n&&i.push(t),e()})},function(t){r(s(i.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};o.filter=l(y),o.filterSeries=h(y),o.select=o.filter,o.selectSeries=o.filterSeries;var v=function(t,e,n,r){var i=[];t(e=s(e,function(t,e){return{index:e,value:t}}),function(t,e){n(t.value,function(n){n||i.push(t),e()})},function(t){r(s(i.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};o.reject=l(v),o.rejectSeries=h(v);var g=function(t,e,n,r){t(e,function(t,e){n(t,function(n){n?(r(t),r=function(){}):e()})},function(t){r()})};o.detect=l(g),o.detectSeries=h(g),o.some=function(t,e,n){o.each(t,function(t,r){e(t,function(t){t&&(n(!0),n=function(){}),r()})},function(t){n(!1)})},o.any=o.some,o.every=function(t,e,n){o.each(t,function(t,r){e(t,function(t){t||(n(!1),n=function(){}),r()})},function(t){n(!0)})},o.all=o.every,o.sortBy=function(t,e,n){o.map(t,function(t,n){e(t,function(e,r){e?n(e):n(null,{value:t,criteria:r})})},function(t,e){if(t)return n(t);n(null,s(e.sort(function(t,e){var n=t.criteria,r=e.criteria;return n<r?-1:n>r?1:0}),function(t){return t.value}))})},o.auto=function(t,e){e=e||function(){};var n=c(t);if(!n.length)return e(null);var r={},i=[],a=function(t){i.unshift(t)},s=function(){u(i.slice(0),function(t){t()})};a(function(){c(r).length===n.length&&(e(null,r),e=function(){})}),u(n,function(n){var f=t[n]instanceof Function?[t[n]]:t[n],l=function(t){var i=Array.prototype.slice.call(arguments,1);if(i.length<=1&&(i=i[0]),t){var a={};u(c(r),function(t){a[t]=r[t]}),a[n]=i,e(t,a),e=function(){}}else r[n]=i,o.setImmediate(s)},h=f.slice(0,Math.abs(f.length-1))||[],p=function(){return e=function(t,e){return t&&r.hasOwnProperty(e)},i=!0,((t=h).reduce?t.reduce(e,i):(u(t,function(t,n,r){i=e(i,t,n,r)}),i))&&!r.hasOwnProperty(n);var t,e,i};if(p())f[f.length-1](l,r);else{var d=function(){p()&&(!function(t){for(var e=0;e<i.length;e+=1)if(i[e]===t)return void i.splice(e,1)}(d),f[f.length-1](l,r))};a(d)}})},o.waterfall=function(t,e){if(e=e||function(){},t.constructor!==Array){var n=new Error("First argument to waterfall must be an array of functions");return e(n)}if(!t.length)return e();var r=function(t){return function(n){if(n)e.apply(null,arguments),e=function(){};else{var i=Array.prototype.slice.call(arguments,1),a=t.next();a?i.push(r(a)):i.push(e),o.setImmediate(function(){t.apply(null,i)})}}};r(o.iterator(t))()};var m=function(t,e,n){if(n=n||function(){},e.constructor===Array)t.map(e,function(t,e){t&&t(function(t){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),e.call(null,t,n)})},n);else{var r={};t.each(c(e),function(t,n){e[t](function(e){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),r[t]=i,n(e)})},function(t){n(t,r)})}};o.parallel=function(t,e){m({map:o.map,each:o.each},t,e)},o.parallelLimit=function(t,e,n){m({map:d(e),each:f(e)},t,n)},o.series=function(t,e){if(e=e||function(){},t.constructor===Array)o.mapSeries(t,function(t,e){t&&t(function(t){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),e.call(null,t,n)})},e);else{var n={};o.eachSeries(c(t),function(e,r){t[e](function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),n[e]=i,r(t)})},function(t){e(t,n)})}},o.iterator=function(t){var e=function(n){var r=function(){return t.length&&t[n].apply(null,arguments),r.next()};return r.next=function(){return n<t.length-1?e(n+1):null},r};return e(0)},o.apply=function(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var _=function(t,e,n,r){var i=[];t(e,function(t,e){n(t,function(t,n){i=i.concat(n||[]),e(t)})},function(t){r(t,i)})};o.concat=l(_),o.concatSeries=h(_),o.whilst=function(t,e,n){t()?e(function(r){if(r)return n(r);o.whilst(t,e,n)}):n()},o.doWhilst=function(t,e,n){t(function(r){if(r)return n(r);e()?o.doWhilst(t,e,n):n()})},o.until=function(t,e,n){t()?n():e(function(r){if(r)return n(r);o.until(t,e,n)})},o.doUntil=function(t,e,n){t(function(r){if(r)return n(r);e()?n():o.doUntil(t,e,n)})},o.queue=function(t,e){function n(t,n,r,i){n.constructor!==Array&&(n=[n]),u(n,function(n){var a={data:n,callback:"function"==typeof i?i:null};r?t.tasks.unshift(a):t.tasks.push(a),t.saturated&&t.tasks.length===e&&t.saturated(),o.setImmediate(t.process)})}void 0===e&&(e=1);var r=0,i={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,push:function(t,e){n(i,t,!1,e)},unshift:function(t,e){n(i,t,!0,e)},process:function(){if(r<i.concurrency&&i.tasks.length){var e=i.tasks.shift();i.empty&&0===i.tasks.length&&i.empty(),r+=1;var n=a(function(){r-=1,e.callback&&e.callback.apply(e,arguments),i.drain&&i.tasks.length+r===0&&i.drain(),i.process()});t(e.data,n)}},length:function(){return i.tasks.length},running:function(){return r}};return i},o.cargo=function(t,e){var n=!1,r=[],i={tasks:r,payload:e,saturated:null,empty:null,drain:null,push:function(t,n){t.constructor!==Array&&(t=[t]),u(t,function(t){r.push({data:t,callback:"function"==typeof n?n:null}),i.saturated&&r.length===e&&i.saturated()}),o.setImmediate(i.process)},process:function o(){if(!n)if(0!==r.length){var a="number"==typeof e?r.splice(0,e):r.splice(0),c=s(a,function(t){return t.data});i.empty&&i.empty(),n=!0,t(c,function(){n=!1;var t=arguments;u(a,function(e){e.callback&&e.callback.apply(null,t)}),o()})}else i.drain&&i.drain()},length:function(){return r.length},running:function(){return n}};return i};var b=function(t){return function(e){var n=Array.prototype.slice.call(arguments,1);e.apply(null,n.concat([function(e){var n=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(e?console.error&&console.error(e):console[t]&&u(n,function(e){console[t](e)}))}]))}};o.log=b("log"),o.dir=b("dir"),o.memoize=function(t,e){var n={},r={};e=e||function(t){return t};var i=function(){var i=Array.prototype.slice.call(arguments),o=i.pop(),a=e.apply(null,i);a in n?o.apply(null,n[a]):a in r?r[a].push(o):(r[a]=[o],t.apply(null,i.concat([function(){n[a]=arguments;var t=r[a];delete r[a];for(var e=0,i=t.length;e<i;e++)t[e].apply(null,arguments)}])))};return i.memo=n,i.unmemoized=t,i},o.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},o.times=function(t,e,n){for(var r=[],i=0;i<t;i++)r.push(i);return o.map(r,e,n)},o.timesSeries=function(t,e,n){for(var r=[],i=0;i<t;i++)r.push(i);return o.mapSeries(r,e,n)},o.compose=function(){var t=Array.prototype.reverse.call(arguments);return function(){var e=this,n=Array.prototype.slice.call(arguments),r=n.pop();o.reduce(t,n,function(t,n,r){n.apply(e,t.concat([function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);r(t,e)}]))},function(t,n){r.apply(e,[t].concat(n))})}};var w=function(t,e){var n=function(){var n=this,r=Array.prototype.slice.call(arguments),i=r.pop();return t(e,function(t,e){t.apply(n,r.concat([e]))},i)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return n.apply(this,r)}return n};o.applyEach=l(w),o.applyEachSeries=h(w),o.forever=function(t,e){!function n(r){if(r){if(e)return e(r);throw r}t(n)}()},void 0!==e&&e.exports?e.exports=o:r.async=o}()}).call(this,t("_process"),t("timers").setImmediate)},{_process:3,timers:4}],26:[function(t,e,n){(function(r){!function(t){"object"==typeof n&&void 0!==e?e.exports=t():("undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:this).localforage=t()}(function(){return function e(n,r,i){function o(u,s){if(!r[u]){if(!n[u]){var c="function"==typeof t&&t;if(!s&&c)return c(u,!0);if(a)return a(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var l=r[u]={exports:{}};n[u][0].call(l.exports,function(t){var e=n[u][1][t];return o(e||t)},l,l.exports,e,n,r,i)}return r[u].exports}for(var a="function"==typeof t&&t,u=0;u<i.length;u++)o(i[u]);return o}({1:[function(t,e,n){(function(t){"use strict";var n,r,i=t.MutationObserver||t.WebKitMutationObserver;if(i){var o=0,a=new i(f),u=t.document.createTextNode("");a.observe(u,{characterData:!0}),n=function(){u.data=o=++o%2}}else if(t.setImmediate||void 0===t.MessageChannel)n="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){f(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(f,0)};else{var s=new t.MessageChannel;s.port1.onmessage=f,n=function(){s.port2.postMessage(0)}}var c=[];function f(){var t,e;r=!0;for(var n=c.length;n;){for(e=c,c=[],t=-1;++t<n;)e[t]();n=c.length}r=!1}e.exports=function(t){1!==c.push(t)||r||n()}}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){"use strict";var r=t(1);function i(){}var o={},a=["REJECTED"],u=["FULFILLED"],s=["PENDING"];function c(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=s,this.queue=[],this.outcome=void 0,t!==i&&p(this,t)}function f(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function l(t,e,n){r(function(){var r;try{r=e(n)}catch(e){return o.reject(t,e)}r===t?o.reject(t,new TypeError("Cannot resolve promise with itself")):o.resolve(t,r)})}function h(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function p(t,e){var n=!1;function r(e){n||(n=!0,o.reject(t,e))}function i(e){n||(n=!0,o.resolve(t,e))}var a=d(function(){e(i,r)});"error"===a.status&&r(a.value)}function d(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}e.exports=c,c.prototype.catch=function(t){return this.then(null,t)},c.prototype.then=function(t,e){if("function"!=typeof t&&this.state===u||"function"!=typeof e&&this.state===a)return this;var n=new this.constructor(i);this.state!==s?l(n,this.state===u?t:e,this.outcome):this.queue.push(new f(n,t,e));return n},f.prototype.callFulfilled=function(t){o.resolve(this.promise,t)},f.prototype.otherCallFulfilled=function(t){l(this.promise,this.onFulfilled,t)},f.prototype.callRejected=function(t){o.reject(this.promise,t)},f.prototype.otherCallRejected=function(t){l(this.promise,this.onRejected,t)},o.resolve=function(t,e){var n=d(h,e);if("error"===n.status)return o.reject(t,n.value);var r=n.value;if(r)p(t,r);else{t.state=u,t.outcome=e;for(var i=-1,a=t.queue.length;++i<a;)t.queue[i].callFulfilled(e)}return t},o.reject=function(t,e){t.state=a,t.outcome=e;for(var n=-1,r=t.queue.length;++n<r;)t.queue[n].callRejected(e);return t},c.resolve=function(t){if(t instanceof this)return t;return o.resolve(new this(i),t)},c.reject=function(t){var e=new this(i);return o.reject(e,t)},c.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);var a=new Array(n),u=0,s=-1,c=new this(i);for(;++s<n;)f(t[s],s);return c;function f(t,i){e.resolve(t).then(function(t){a[i]=t,++u!==n||r||(r=!0,o.resolve(c,a))},function(t){r||(r=!0,o.reject(c,t))})}},c.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);var a=-1,u=new this(i);for(;++a<n;)s=t[a],e.resolve(s).then(function(t){r||(r=!0,o.resolve(u,t))},function(t){r||(r=!0,o.reject(u,t))});var s;return u}},{1:1}],3:[function(t,e,n){(function(e){"use strict";"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};var i=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}();function o(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(i){if("TypeError"!==i.name)throw i;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<t.length;r+=1)n.append(t[r]);return n.getBlob(e.type)}}"undefined"==typeof Promise&&t(3);var a=Promise;function u(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}function s(t,e,n){"function"==typeof e&&t.then(e),"function"==typeof n&&t.catch(n)}function c(t){return"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function f(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var l="local-forage-detect-blob-support",h=void 0,p={},d=Object.prototype.toString,y="readonly",v="readwrite";function g(t){return"boolean"==typeof h?a.resolve(h):function(t){return new a(function(e){var n=t.transaction(l,v),r=o([""]);n.objectStore(l).put(r,"key"),n.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},n.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||parseInt(t[1],10)>=43)}}).catch(function(){return!1})}(t).then(function(t){return h=t})}function m(t){var e=p[t.name],n={};n.promise=new a(function(t,e){n.resolve=t,n.reject=e}),e.deferredOperations.push(n),e.dbReady?e.dbReady=e.dbReady.then(function(){return n.promise}):e.dbReady=n.promise}function _(t){var e=p[t.name].deferredOperations.pop();if(e)return e.resolve(),e.promise}function b(t,e){var n=p[t.name].deferredOperations.pop();if(n)return n.reject(e),n.promise}function w(t,e){return new a(function(n,r){if(p[t.name]=p[t.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},t.db){if(!e)return n(t.db);m(t),t.db.close()}var o=[t.name];e&&o.push(t.version);var a=i.open.apply(i,o);e&&(a.onupgradeneeded=function(e){var n=a.result;try{n.createObjectStore(t.storeName),e.oldVersion<=1&&n.createObjectStore(l)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),a.onerror=function(t){t.preventDefault(),r(a.error)},a.onsuccess=function(){var e=a.result;e.onversionchange=function(t){t.target.close()},n(e),_(t)}})}function x(t){return w(t,!1)}function k(t){return w(t,!0)}function E(t,e){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),r=t.version<t.db.version,i=t.version>t.db.version;if(r&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),i||n){if(n){var o=t.db.version+1;o>t.version&&(t.version=o)}return!0}return!1}function A(t){return o([function(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),i=0;i<e;i++)r[i]=t.charCodeAt(i);return n}(atob(t.data))],{type:t.type})}function O(t){return t&&t.__local_forage_encoded_blob}function I(t){var e=this,n=e._initReady().then(function(){var t=p[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return s(n,t,t),n}function j(t,e,n,r){void 0===r&&(r=1);try{var i=t.db.transaction(t.storeName,e);n(null,i)}catch(i){if(r>0&&(!t.db||"InvalidStateError"===i.name||"NotFoundError"===i.name))return a.resolve().then(function(){if(!t.db||"NotFoundError"===i.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),k(t)}).then(function(){return function(t){m(t);for(var e=p[t.name],n=e.forages,r=0;r<n.length;r++){var i=n[r];i._dbInfo.db&&(i._dbInfo.db.close(),i._dbInfo.db=null)}return t.db=null,x(t).then(function(e){return t.db=e,E(t)?k(t):e}).then(function(r){t.db=e.db=r;for(var i=0;i<n.length;i++)n[i]._dbInfo.db=r}).catch(function(e){throw b(t,e),e})}(t).then(function(){j(t,e,n,r-1)})}).catch(n);n(i)}}var S={_driver:"asyncStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var r in t)n[r]=t[r];var i=p[n.name];i||(i={forages:[],db:null,dbReady:null,deferredOperations:[]},p[n.name]=i),i.forages.push(e),e._initReady||(e._initReady=e.ready,e.ready=I);var o=[];function u(){return a.resolve()}for(var s=0;s<i.forages.length;s++){var c=i.forages[s];c!==e&&o.push(c._initReady().catch(u))}var f=i.forages.slice(0);return a.all(o).then(function(){return n.db=i.db,x(n)}).then(function(t){return n.db=t,E(n,e._defaultConfig.version)?k(n):t}).then(function(t){n.db=i.db=t,e._dbInfo=n;for(var r=0;r<f.length;r++){var o=f[r];o!==e&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}})},_support:function(){try{if(!i||!i.open)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}(),iterate:function(t,e){var n=this,r=new a(function(e,r){n.ready().then(function(){j(n._dbInfo,y,function(i,o){if(i)return r(i);try{var a=o.objectStore(n._dbInfo.storeName).openCursor(),u=1;a.onsuccess=function(){var n=a.result;if(n){var r=n.value;O(r)&&(r=A(r));var i=t(r,n.key,u++);void 0!==i?e(i):n.continue()}else e()},a.onerror=function(){r(a.error)}}catch(t){r(t)}})}).catch(r)});return u(r,e),r},getItem:function(t,e){var n=this;t=c(t);var r=new a(function(e,r){n.ready().then(function(){j(n._dbInfo,y,function(i,o){if(i)return r(i);try{var a=o.objectStore(n._dbInfo.storeName).get(t);a.onsuccess=function(){var t=a.result;void 0===t&&(t=null),O(t)&&(t=A(t)),e(t)},a.onerror=function(){r(a.error)}}catch(t){r(t)}})}).catch(r)});return u(r,e),r},setItem:function(t,e,n){var r=this;t=c(t);var i=new a(function(n,i){var o;r.ready().then(function(){return o=r._dbInfo,"[object Blob]"===d.call(e)?g(o.db).then(function(t){return t?e:(n=e,new a(function(t,e){var r=new FileReader;r.onerror=e,r.onloadend=function(e){var r=btoa(e.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:n.type})},r.readAsBinaryString(n)}));var n}):e}).then(function(e){j(r._dbInfo,v,function(o,a){if(o)return i(o);try{var u=a.objectStore(r._dbInfo.storeName);null===e&&(e=void 0);var s=u.put(e,t);a.oncomplete=function(){void 0===e&&(e=null),n(e)},a.onabort=a.onerror=function(){var t=s.error?s.error:s.transaction.error;i(t)}}catch(t){i(t)}})}).catch(i)});return u(i,n),i},removeItem:function(t,e){var n=this;t=c(t);var r=new a(function(e,r){n.ready().then(function(){j(n._dbInfo,v,function(i,o){if(i)return r(i);try{var a=o.objectStore(n._dbInfo.storeName).delete(t);o.oncomplete=function(){e()},o.onerror=function(){r(a.error)},o.onabort=function(){var t=a.error?a.error:a.transaction.error;r(t)}}catch(t){r(t)}})}).catch(r)});return u(r,e),r},clear:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){j(e._dbInfo,v,function(r,i){if(r)return n(r);try{var o=i.objectStore(e._dbInfo.storeName).clear();i.oncomplete=function(){t()},i.onabort=i.onerror=function(){var t=o.error?o.error:o.transaction.error;n(t)}}catch(t){n(t)}})}).catch(n)});return u(n,t),n},length:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){j(e._dbInfo,y,function(r,i){if(r)return n(r);try{var o=i.objectStore(e._dbInfo.storeName).count();o.onsuccess=function(){t(o.result)},o.onerror=function(){n(o.error)}}catch(t){n(t)}})}).catch(n)});return u(n,t),n},key:function(t,e){var n=this,r=new a(function(e,r){t<0?e(null):n.ready().then(function(){j(n._dbInfo,y,function(i,o){if(i)return r(i);try{var a=o.objectStore(n._dbInfo.storeName),u=!1,s=a.openKeyCursor();s.onsuccess=function(){var n=s.result;n?0===t?e(n.key):u?e(n.key):(u=!0,n.advance(t)):e(null)},s.onerror=function(){r(s.error)}}catch(t){r(t)}})}).catch(r)});return u(r,e),r},keys:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){j(e._dbInfo,y,function(r,i){if(r)return n(r);try{var o=i.objectStore(e._dbInfo.storeName).openKeyCursor(),a=[];o.onsuccess=function(){var e=o.result;e?(a.push(e.key),e.continue()):t(a)},o.onerror=function(){n(o.error)}}catch(t){n(t)}})}).catch(n)});return u(n,t),n},dropInstance:function(t,e){e=f.apply(this,arguments);var n,r=this.config();if((t="function"!=typeof t&&t||{}).name||(t.name=t.name||r.name,t.storeName=t.storeName||r.storeName),t.name){var o=t.name===r.name&&this._dbInfo.db?a.resolve(this._dbInfo.db):x(t).then(function(e){var n=p[t.name],r=n.forages;n.db=e;for(var i=0;i<r.length;i++)r[i]._dbInfo.db=e;return e});n=t.storeName?o.then(function(e){if(e.objectStoreNames.contains(t.storeName)){var n=e.version+1;m(t);var r=p[t.name],o=r.forages;e.close();for(var u=0;u<o.length;u++){var s=o[u];s._dbInfo.db=null,s._dbInfo.version=n}return new a(function(e,r){var o=i.open(t.name,n);o.onerror=function(t){o.result.close(),r(t)},o.onupgradeneeded=function(){o.result.deleteObjectStore(t.storeName)},o.onsuccess=function(){var t=o.result;t.close(),e(t)}}).then(function(t){r.db=t;for(var e=0;e<o.length;e++){var n=o[e];n._dbInfo.db=t,_(n._dbInfo)}}).catch(function(e){throw(b(t,e)||a.resolve()).catch(function(){}),e})}}):o.then(function(e){m(t);var n=p[t.name],r=n.forages;e.close();for(var o=0;o<r.length;o++)r[o]._dbInfo.db=null;return new a(function(e,n){var r=i.deleteDatabase(t.name);r.onerror=function(){var t=r.result;t&&t.close(),n(r.error)},r.onblocked=function(){console.warn('dropInstance blocked for database "'+t.name+'" until all open connections are closed')},r.onsuccess=function(){var t=r.result;t&&t.close(),e(t)}}).then(function(t){n.db=t;for(var e=0;e<r.length;e++)_(r[e]._dbInfo)}).catch(function(e){throw(b(t,e)||a.resolve()).catch(function(){}),e})})}else n=a.reject("Invalid arguments");return u(n,e),n}};var N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",D="~~local_forage_type~",T=/^~~local_forage_type~([^~]+)~/,C="__lfsc__:",$=C.length,M="arbf",P="blob",F="si08",R="ui08",B="uic8",L="si16",z="si32",q="ur16",K="ui32",U="fl32",V="fl64",W=$+M.length,J=Object.prototype.toString;function H(t){var e,n,r,i,o,a=.75*t.length,u=t.length,s=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var c=new ArrayBuffer(a),f=new Uint8Array(c);for(e=0;e<u;e+=4)n=N.indexOf(t[e]),r=N.indexOf(t[e+1]),i=N.indexOf(t[e+2]),o=N.indexOf(t[e+3]),f[s++]=n<<2|r>>4,f[s++]=(15&r)<<4|i>>2,f[s++]=(3&i)<<6|63&o;return c}function G(t){var e,n=new Uint8Array(t),r="";for(e=0;e<n.length;e+=3)r+=N[n[e]>>2],r+=N[(3&n[e])<<4|n[e+1]>>4],r+=N[(15&n[e+1])<<2|n[e+2]>>6],r+=N[63&n[e+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var Q={serialize:function(t,e){var n="";if(t&&(n=J.call(t)),t&&("[object ArrayBuffer]"===n||t.buffer&&"[object ArrayBuffer]"===J.call(t.buffer))){var r,i=C;t instanceof ArrayBuffer?(r=t,i+=M):(r=t.buffer,"[object Int8Array]"===n?i+=F:"[object Uint8Array]"===n?i+=R:"[object Uint8ClampedArray]"===n?i+=B:"[object Int16Array]"===n?i+=L:"[object Uint16Array]"===n?i+=q:"[object Int32Array]"===n?i+=z:"[object Uint32Array]"===n?i+=K:"[object Float32Array]"===n?i+=U:"[object Float64Array]"===n?i+=V:e(new Error("Failed to get type for BinaryArray"))),e(i+G(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n=D+t.type+"~"+G(this.result);e(C+P+n)},o.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(n){console.error("Couldn't convert value into a JSON string: ",t),e(null,n)}},deserialize:function(t){if(t.substring(0,$)!==C)return JSON.parse(t);var e,n=t.substring(W),r=t.substring($,W);if(r===P&&T.test(n)){var i=n.match(T);e=i[1],n=n.substring(i[0].length)}var a=H(n);switch(r){case M:return a;case P:return o([a],{type:e});case F:return new Int8Array(a);case R:return new Uint8Array(a);case B:return new Uint8ClampedArray(a);case L:return new Int16Array(a);case q:return new Uint16Array(a);case z:return new Int32Array(a);case K:return new Uint32Array(a);case U:return new Float32Array(a);case V:return new Float64Array(a);default:throw new Error("Unkown type: "+r)}},stringToBuffer:H,bufferToString:G};function Y(t,e,n,r){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function X(t,e,n,r,i,o){t.executeSql(n,r,i,function(t,a){a.code===a.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[e.storeName],function(t,u){u.rows.length?o(t,a):Y(t,e,function(){t.executeSql(n,r,i,o)},o)},o):o(t,a)},o)}var Z={_driver:"webSQLStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var r in t)n[r]="string"!=typeof t[r]?t[r].toString():t[r];var i=new a(function(t,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(t){return r(t)}n.db.transaction(function(i){Y(i,n,function(){e._dbInfo=n,t()},function(t,e){r(e)})},r)});return n.serializer=Q,i},_support:"function"==typeof openDatabase,iterate:function(t,e){var n=this,r=new a(function(e,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){X(n,i,"SELECT * FROM "+i.storeName,[],function(n,r){for(var o=r.rows,a=o.length,u=0;u<a;u++){var s=o.item(u),c=s.value;if(c&&(c=i.serializer.deserialize(c)),void 0!==(c=t(c,s.key,u+1)))return void e(c)}e()},function(t,e){r(e)})})}).catch(r)});return u(r,e),r},getItem:function(t,e){var n=this;t=c(t);var r=new a(function(e,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){X(n,i,"SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[t],function(t,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=i.serializer.deserialize(r)),e(r)},function(t,e){r(e)})})}).catch(r)});return u(r,e),r},setItem:function(t,e,n){return function t(e,n,r,i){var o=this;e=c(e);var s=new a(function(a,u){o.ready().then(function(){void 0===n&&(n=null);var s=n,c=o._dbInfo;c.serializer.serialize(n,function(n,f){f?u(f):c.db.transaction(function(t){X(t,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,n],function(){a(s)},function(t,e){u(e)})},function(n){if(n.code===n.QUOTA_ERR){if(i>0)return void a(t.apply(o,[e,s,r,i-1]));u(n)}})})}).catch(u)});return u(s,r),s}.apply(this,[t,e,n,1])},removeItem:function(t,e){var n=this;t=c(t);var r=new a(function(e,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){X(n,i,"DELETE FROM "+i.storeName+" WHERE key = ?",[t],function(){e()},function(t,e){r(e)})})}).catch(r)});return u(r,e),r},clear:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){X(e,r,"DELETE FROM "+r.storeName,[],function(){t()},function(t,e){n(e)})})}).catch(n)});return u(n,t),n},length:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){X(e,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],function(e,n){var r=n.rows.item(0).c;t(r)},function(t,e){n(e)})})}).catch(n)});return u(n,t),n},key:function(t,e){var n=this,r=new a(function(e,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){X(n,i,"SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[t+1],function(t,n){var r=n.rows.length?n.rows.item(0).key:null;e(r)},function(t,e){r(e)})})}).catch(r)});return u(r,e),r},keys:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){X(e,r,"SELECT key FROM "+r.storeName,[],function(e,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i).key);t(r)},function(t,e){n(e)})})}).catch(n)});return u(n,t),n},dropInstance:function(t,e){e=f.apply(this,arguments);var n=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var r,i=this;return u(r=t.name?new a(function(e){var r;r=t.name===n.name?i._dbInfo.db:openDatabase(t.name,"","",0),t.storeName?e({db:r,storeNames:[t.storeName]}):e(function(t){return new a(function(e,n){t.transaction(function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(n,r){for(var i=[],o=0;o<r.rows.length;o++)i.push(r.rows.item(o).name);e({db:t,storeNames:i})},function(t,e){n(e)})},function(t){n(t)})})}(r))}).then(function(t){return new a(function(e,n){t.db.transaction(function(r){function i(t){return new a(function(e,n){r.executeSql("DROP TABLE IF EXISTS "+t,[],function(){e()},function(t,e){n(e)})})}for(var o=[],u=0,s=t.storeNames.length;u<s;u++)o.push(i(t.storeNames[u]));a.all(o).then(function(){e()}).catch(function(t){n(t)})},function(t){n(t)})})}):a.reject("Invalid arguments"),e),r}};function tt(t,e){var n=t.name+"/";return t.storeName!==e.storeName&&(n+=t.storeName+"/"),n}function et(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(t){return!0}}()||localStorage.length>0}var nt={_driver:"localStorageWrapper",_initStorage:function(t){var e={};if(t)for(var n in t)e[n]=t[n];return e.keyPrefix=tt(t,this._defaultConfig),et()?(this._dbInfo=e,e.serializer=Q,a.resolve()):a.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}(),iterate:function(t,e){var n=this,r=n.ready().then(function(){for(var e=n._dbInfo,r=e.keyPrefix,i=r.length,o=localStorage.length,a=1,u=0;u<o;u++){var s=localStorage.key(u);if(0===s.indexOf(r)){var c=localStorage.getItem(s);if(c&&(c=e.serializer.deserialize(c)),void 0!==(c=t(c,s.substring(i),a++)))return c}}});return u(r,e),r},getItem:function(t,e){var n=this;t=c(t);var r=n.ready().then(function(){var e=n._dbInfo,r=localStorage.getItem(e.keyPrefix+t);return r&&(r=e.serializer.deserialize(r)),r});return u(r,e),r},setItem:function(t,e,n){var r=this;t=c(t);var i=r.ready().then(function(){void 0===e&&(e=null);var n=e;return new a(function(i,o){var a=r._dbInfo;a.serializer.serialize(e,function(e,r){if(r)o(r);else try{localStorage.setItem(a.keyPrefix+t,e),i(n)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||o(t),o(t)}})})});return u(i,n),i},removeItem:function(t,e){var n=this;t=c(t);var r=n.ready().then(function(){var e=n._dbInfo;localStorage.removeItem(e.keyPrefix+t)});return u(r,e),r},clear:function(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(t)&&localStorage.removeItem(r)}});return u(n,t),n},length:function(t){var e=this.keys().then(function(t){return t.length});return u(e,t),e},key:function(t,e){var n=this,r=n.ready().then(function(){var e,r=n._dbInfo;try{e=localStorage.key(t)}catch(t){e=null}return e&&(e=e.substring(r.keyPrefix.length)),e});return u(r,e),r},keys:function(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo,n=localStorage.length,r=[],i=0;i<n;i++){var o=localStorage.key(i);0===o.indexOf(t.keyPrefix)&&r.push(o.substring(t.keyPrefix.length))}return r});return u(n,t),n},dropInstance:function(t,e){if(e=f.apply(this,arguments),!(t="function"!=typeof t&&t||{}).name){var n=this.config();t.name=t.name||n.name,t.storeName=t.storeName||n.storeName}var r,i=this;return u(r=t.name?new a(function(e){t.storeName?e(tt(t,i._defaultConfig)):e(t.name+"/")}).then(function(t){for(var e=localStorage.length-1;e>=0;e--){var n=localStorage.key(e);0===n.indexOf(t)&&localStorage.removeItem(n)}}):a.reject("Invalid arguments"),e),r}},rt=function(t,e){for(var n,r,i=t.length,o=0;o<i;){if((n=t[o])===(r=e)||"number"==typeof n&&"number"==typeof r&&isNaN(n)&&isNaN(r))return!0;o++}return!1},it=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},ot={},at={},ut={INDEXEDDB:S,WEBSQL:Z,LOCALSTORAGE:nt},st=[ut.INDEXEDDB._driver,ut.WEBSQL._driver,ut.LOCALSTORAGE._driver],ct=["dropInstance"],ft=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ct),lt={description:"",driver:st.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ht(t,e){t[e]=function(){var n=arguments;return t.ready().then(function(){return t[e].apply(t,n)})}}function pt(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(it(e[n])?arguments[0][n]=e[n].slice():arguments[0][n]=e[n])}return arguments[0]}var dt=new(function(){function t(e){for(var n in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ut)if(ut.hasOwnProperty(n)){var r=ut[n],i=r._driver;this[n]=i,ot[i]||this.defineDriver(r)}this._defaultConfig=pt({},lt),this._config=pt({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return t.prototype.config=function(t){if("object"===(void 0===t?"undefined":r(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t&&t.driver)||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,n){var r=new a(function(e,n){try{var r=t._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver)return void n(i);for(var o=ft.concat("_initStorage"),s=0,c=o.length;s<c;s++){var f=o[s];if((!rt(ct,f)||t[f])&&"function"!=typeof t[f])return void n(i)}!function(){for(var e=function(t){return function(){var e=new Error("Method "+t+" is not implemented by the current driver"),n=a.reject(e);return u(n,arguments[arguments.length-1]),n}},n=0,r=ct.length;n<r;n++){var i=ct[n];t[i]||(t[i]=e(i))}}();var l=function(n){ot[r]&&console.info("Redefining LocalForage driver: "+r),ot[r]=t,at[r]=n,e()};"_support"in t?t._support&&"function"==typeof t._support?t._support().then(l,n):l(!!t._support):l(!0)}catch(t){n(t)}});return s(r,e,n),r},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,n){var r=ot[t]?a.resolve(ot[t]):a.reject(new Error("Driver not found."));return s(r,e,n),r},t.prototype.getSerializer=function(t){var e=a.resolve(Q);return s(e,t),e},t.prototype.ready=function(t){var e=this,n=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return s(n,t,t),n},t.prototype.setDriver=function(t,e,n){var r=this;it(t)||(t=[t]);var i=this._getSupportedDrivers(t);function o(){r._config.driver=r.driver()}function u(t){return r._extend(t),o(),r._ready=r._initStorage(r._config),r._ready}var c=null!==this._driverSet?this._driverSet.catch(function(){return a.resolve()}):a.resolve();return this._driverSet=c.then(function(){var t=i[0];return r._dbInfo=null,r._ready=null,r.getDriver(t).then(function(t){r._driver=t._driver,o(),r._wrapLibraryMethodsWithReady(),r._initDriver=function(t){return function(){var e=0;return function n(){for(;e<t.length;){var i=t[e];return e++,r._dbInfo=null,r._ready=null,r.getDriver(i).then(u).catch(n)}o();var s=new Error("No available storage method found.");return r._driverSet=a.reject(s),r._driverSet}()}}(i)})}).catch(function(){o();var t=new Error("No available storage method found.");return r._driverSet=a.reject(t),r._driverSet}),s(this._driverSet,e,n),this._driverSet},t.prototype.supports=function(t){return!!at[t]},t.prototype._extend=function(t){pt(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];this.supports(i)&&e.push(i)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=ft.length;t<e;t++)ht(this,ft[t])},t.prototype.createInstance=function(e){return new t(e)},t}());e.exports=dt},{3:3}]},{},[4])(4)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],27:[function(t,e,n){(function(t){!function(t,r){"object"==typeof n&&void 0!==e?e.exports=r():(t="undefined"!=typeof globalThis?globalThis:t||self,function(){var e=t._,n=t._=r();n.noConflict=function(){return t._=e,n}}())}(this,function(){var e="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||Function("return this")()||{},n=Array.prototype,r=Object.prototype,i="undefined"!=typeof Symbol?Symbol.prototype:null,o=n.push,a=n.slice,u=r.toString,s=r.hasOwnProperty,c="undefined"!=typeof ArrayBuffer,f="undefined"!=typeof DataView,l=Array.isArray,h=Object.keys,p=Object.create,d=c&&ArrayBuffer.isView,y=isNaN,v=isFinite,g=!{toString:null}.propertyIsEnumerable("toString"),m=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],_=Math.pow(2,53)-1;function b(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),r=Array(n),i=0;i<n;i++)r[i]=arguments[i+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r);case 2:return t.call(this,arguments[0],arguments[1],r)}var o=Array(e+1);for(i=0;i<e;i++)o[i]=arguments[i];return o[e]=r,t.apply(this,o)}}function w(t){var e=typeof t;return"function"===e||"object"===e&&!!t}function x(t){return void 0===t}function k(t){return!0===t||!1===t||"[object Boolean]"===u.call(t)}function E(t){var e="[object "+t+"]";return function(t){return u.call(t)===e}}var A=E("String"),O=E("Number"),I=E("Date"),j=E("RegExp"),S=E("Error"),N=E("Symbol"),D=E("ArrayBuffer"),T=E("Function"),C=e.document&&e.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof C&&(T=function(t){return"function"==typeof t||!1});var $=T,M=E("Object"),P=f&&M(new DataView(new ArrayBuffer(8))),F="undefined"!=typeof Map&&M(new Map),R=E("DataView");var B=P?function(t){return null!=t&&$(t.getInt8)&&D(t.buffer)}:R,L=l||E("Array");function z(t,e){return null!=t&&s.call(t,e)}var q=E("Arguments");!function(){q(arguments)||(q=function(t){return z(t,"callee")})}();var K=q;function U(t){return O(t)&&y(t)}function V(t){return function(){return t}}function W(t){return function(e){var n=t(e);return"number"==typeof n&&n>=0&&n<=_}}function J(t){return function(e){return null==e?void 0:e[t]}}var H=J("byteLength"),G=W(H),Q=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var Y=c?function(t){return d?d(t)&&!B(t):G(t)&&Q.test(u.call(t))}:V(!1),X=J("length");function Z(t,e){e=function(t){for(var e={},n=t.length,r=0;r<n;++r)e[t[r]]=!0;return{contains:function(t){return!0===e[t]},push:function(n){return e[n]=!0,t.push(n)}}}(e);var n=m.length,i=t.constructor,o=$(i)&&i.prototype||r,a="constructor";for(z(t,a)&&!e.contains(a)&&e.push(a);n--;)(a=m[n])in t&&t[a]!==o[a]&&!e.contains(a)&&e.push(a)}function tt(t){if(!w(t))return[];if(h)return h(t);var e=[];for(var n in t)z(t,n)&&e.push(n);return g&&Z(t,e),e}function et(t,e){var n=tt(e),r=n.length;if(null==t)return!r;for(var i=Object(t),o=0;o<r;o++){var a=n[o];if(e[a]!==i[a]||!(a in i))return!1}return!0}function nt(t){return t instanceof nt?t:this instanceof nt?void(this._wrapped=t):new nt(t)}function rt(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,H(t))}nt.VERSION="1.13.2",nt.prototype.value=function(){return this._wrapped},nt.prototype.valueOf=nt.prototype.toJSON=nt.prototype.value,nt.prototype.toString=function(){return String(this._wrapped)};var it="[object DataView]";function ot(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var o=typeof t;return("function"===o||"object"===o||"object"==typeof e)&&function t(e,n,r,o){e instanceof nt&&(e=e._wrapped);n instanceof nt&&(n=n._wrapped);var a=u.call(e);if(a!==u.call(n))return!1;if(P&&"[object Object]"==a&&B(e)){if(!B(n))return!1;a=it}switch(a){case"[object RegExp]":case"[object String]":return""+e==""+n;case"[object Number]":return+e!=+e?+n!=+n:0==+e?1/+e==1/n:+e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object Symbol]":return i.valueOf.call(e)===i.valueOf.call(n);case"[object ArrayBuffer]":case it:return t(rt(e),rt(n),r,o)}var s="[object Array]"===a;if(!s&&Y(e)){var c=H(e);if(c!==H(n))return!1;if(e.buffer===n.buffer&&e.byteOffset===n.byteOffset)return!0;s=!0}if(!s){if("object"!=typeof e||"object"!=typeof n)return!1;var f=e.constructor,l=n.constructor;if(f!==l&&!($(f)&&f instanceof f&&$(l)&&l instanceof l)&&"constructor"in e&&"constructor"in n)return!1}r=r||[];o=o||[];var h=r.length;for(;h--;)if(r[h]===e)return o[h]===n;r.push(e);o.push(n);if(s){if((h=e.length)!==n.length)return!1;for(;h--;)if(!ot(e[h],n[h],r,o))return!1}else{var p,d=tt(e);if(h=d.length,tt(n).length!==h)return!1;for(;h--;)if(p=d[h],!z(n,p)||!ot(e[p],n[p],r,o))return!1}r.pop();o.pop();return!0}(t,e,n,r)}function at(t){if(!w(t))return[];var e=[];for(var n in t)e.push(n);return g&&Z(t,e),e}function ut(t){var e=X(t);return function(n){if(null==n)return!1;var r=at(n);if(X(r))return!1;for(var i=0;i<e;i++)if(!$(n[t[i]]))return!1;return t!==ht||!$(n[st])}}var st="forEach",ct=["clear","delete"],ft=["get","has","set"],lt=ct.concat(st,ft),ht=ct.concat(ft),pt=["add"].concat(ct,st,"has"),dt=F?ut(lt):E("Map"),yt=F?ut(ht):E("WeakMap"),vt=F?ut(pt):E("Set"),gt=E("WeakSet");function mt(t){for(var e=tt(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=t[e[i]];return r}function _t(t){for(var e={},n=tt(t),r=0,i=n.length;r<i;r++)e[t[n[r]]]=n[r];return e}function bt(t){var e=[];for(var n in t)$(t[n])&&e.push(n);return e.sort()}function wt(t,e){return function(n){var r=arguments.length;if(e&&(n=Object(n)),r<2||null==n)return n;for(var i=1;i<r;i++)for(var o=arguments[i],a=t(o),u=a.length,s=0;s<u;s++){var c=a[s];e&&void 0!==n[c]||(n[c]=o[c])}return n}}var xt=wt(at),kt=wt(tt),Et=wt(at,!0);function At(t){if(!w(t))return{};if(p)return p(t);var e=function(){};e.prototype=t;var n=new e;return e.prototype=null,n}function Ot(t){return L(t)?t:[t]}function It(t){return nt.toPath(t)}function jt(t,e){for(var n=e.length,r=0;r<n;r++){if(null==t)return;t=t[e[r]]}return n?t:void 0}function St(t,e,n){var r=jt(t,It(e));return x(r)?n:r}function Nt(t){return t}function Dt(t){return t=kt({},t),function(e){return et(e,t)}}function Tt(t){return t=It(t),function(e){return jt(e,t)}}function Ct(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)}}return function(){return t.apply(e,arguments)}}function $t(t,e,n){return null==t?Nt:$(t)?Ct(t,e,n):w(t)&&!L(t)?Dt(t):Tt(t)}function Mt(t,e){return $t(t,e,1/0)}function Pt(t,e,n){return nt.iteratee!==Mt?nt.iteratee(t,e):$t(t,e,n)}function Ft(){}function Rt(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}nt.toPath=Ot,nt.iteratee=Mt;var Bt=Date.now||function(){return(new Date).getTime()};function Lt(t){var e=function(e){return t[e]},n="(?:"+tt(t).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(i,e):t}}var zt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},qt=Lt(zt),Kt=Lt(_t(zt)),Ut=nt.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Vt=/(.)^/,Wt={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Jt=/\\|'|\r|\n|\u2028|\u2029/g;function Ht(t){return"\\"+Wt[t]}var Gt=/^\s*(\w|\$)+\s*$/;var Qt=0;function Yt(t,e,n,r,i){if(!(r instanceof e))return t.apply(n,i);var o=At(t.prototype),a=t.apply(o,i);return w(a)?a:o}var Xt=b(function(t,e){var n=Xt.placeholder,r=function(){for(var i=0,o=e.length,a=Array(o),u=0;u<o;u++)a[u]=e[u]===n?arguments[i++]:e[u];for(;i<arguments.length;)a.push(arguments[i++]);return Yt(t,r,this,this,a)};return r});Xt.placeholder=nt;var Zt=b(function(t,e,n){if(!$(t))throw new TypeError("Bind must be called on a function");var r=b(function(i){return Yt(t,r,e,this,n.concat(i))});return r}),te=W(X);function ee(t,e,n,r){if(r=r||[],e||0===e){if(e<=0)return r.concat(t)}else e=1/0;for(var i=r.length,o=0,a=X(t);o<a;o++){var u=t[o];if(te(u)&&(L(u)||K(u)))if(e>1)ee(u,e-1,n,r),i=r.length;else for(var s=0,c=u.length;s<c;)r[i++]=u[s++];else n||(r[i++]=u)}return r}var ne=b(function(t,e){var n=(e=ee(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=e[n];t[r]=Zt(t[r],t)}return t});var re=b(function(t,e,n){return setTimeout(function(){return t.apply(null,n)},e)}),ie=Xt(re,nt,1);function oe(t){return function(){return!t.apply(this,arguments)}}function ae(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}}var ue=Xt(ae,2);function se(t,e,n){e=Pt(e,n);for(var r,i=tt(t),o=0,a=i.length;o<a;o++)if(e(t[r=i[o]],r,t))return r}function ce(t){return function(e,n,r){n=Pt(n,r);for(var i=X(e),o=t>0?0:i-1;o>=0&&o<i;o+=t)if(n(e[o],o,e))return o;return-1}}var fe=ce(1),le=ce(-1);function he(t,e,n,r){for(var i=(n=Pt(n,r,1))(e),o=0,a=X(t);o<a;){var u=Math.floor((o+a)/2);n(t[u])<i?o=u+1:a=u}return o}function pe(t,e,n){return function(r,i,o){var u=0,s=X(r);if("number"==typeof o)t>0?u=o>=0?o:Math.max(o+s,u):s=o>=0?Math.min(o+1,s):o+s+1;else if(n&&o&&s)return r[o=n(r,i)]===i?o:-1;if(i!=i)return(o=e(a.call(r,u,s),U))>=0?o+u:-1;for(o=t>0?u:s-1;o>=0&&o<s;o+=t)if(r[o]===i)return o;return-1}}var de=pe(1,fe,he),ye=pe(-1,le);function ve(t,e,n){var r=(te(t)?fe:se)(t,e,n);if(void 0!==r&&-1!==r)return t[r]}function ge(t,e,n){var r,i;if(e=Ct(e,n),te(t))for(r=0,i=t.length;r<i;r++)e(t[r],r,t);else{var o=tt(t);for(r=0,i=o.length;r<i;r++)e(t[o[r]],o[r],t)}return t}function me(t,e,n){e=Pt(e,n);for(var r=!te(t)&&tt(t),i=(r||t).length,o=Array(i),a=0;a<i;a++){var u=r?r[a]:a;o[a]=e(t[u],u,t)}return o}function _e(t){return function(e,n,r,i){var o=arguments.length>=3;return function(e,n,r,i){var o=!te(e)&&tt(e),a=(o||e).length,u=t>0?0:a-1;for(i||(r=e[o?o[u]:u],u+=t);u>=0&&u<a;u+=t){var s=o?o[u]:u;r=n(r,e[s],s,e)}return r}(e,Ct(n,i,4),r,o)}}var be=_e(1),we=_e(-1);function xe(t,e,n){var r=[];return e=Pt(e,n),ge(t,function(t,n,i){e(t,n,i)&&r.push(t)}),r}function ke(t,e,n){e=Pt(e,n);for(var r=!te(t)&&tt(t),i=(r||t).length,o=0;o<i;o++){var a=r?r[o]:o;if(!e(t[a],a,t))return!1}return!0}function Ee(t,e,n){e=Pt(e,n);for(var r=!te(t)&&tt(t),i=(r||t).length,o=0;o<i;o++){var a=r?r[o]:o;if(e(t[a],a,t))return!0}return!1}function Ae(t,e,n,r){return te(t)||(t=mt(t)),("number"!=typeof n||r)&&(n=0),de(t,e,n)>=0}var Oe=b(function(t,e,n){var r,i;return $(e)?i=e:(e=It(e),r=e.slice(0,-1),e=e[e.length-1]),me(t,function(t){var o=i;if(!o){if(r&&r.length&&(t=jt(t,r)),null==t)return;o=t[e]}return null==o?o:o.apply(t,n)})});function Ie(t,e){return me(t,Tt(e))}function je(t,e,n){var r,i,o=-1/0,a=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var u=0,s=(t=te(t)?t:mt(t)).length;u<s;u++)null!=(r=t[u])&&r>o&&(o=r);else e=Pt(e,n),ge(t,function(t,n,r){((i=e(t,n,r))>a||i===-1/0&&o===-1/0)&&(o=t,a=i)});return o}var Se=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Ne(t){return t?L(t)?a.call(t):A(t)?t.match(Se):te(t)?me(t,Nt):mt(t):[]}function De(t,e,n){if(null==e||n)return te(t)||(t=mt(t)),t[Rt(t.length-1)];var r=Ne(t),i=X(r);e=Math.max(Math.min(e,i),0);for(var o=i-1,a=0;a<e;a++){var u=Rt(a,o),s=r[a];r[a]=r[u],r[u]=s}return r.slice(0,e)}function Te(t,e){return function(n,r,i){var o=e?[[],[]]:{};return r=Pt(r,i),ge(n,function(e,i){var a=r(e,i,n);t(o,e,a)}),o}}var Ce=Te(function(t,e,n){z(t,n)?t[n].push(e):t[n]=[e]}),$e=Te(function(t,e,n){t[n]=e}),Me=Te(function(t,e,n){z(t,n)?t[n]++:t[n]=1}),Pe=Te(function(t,e,n){t[n?0:1].push(e)},!0);function Fe(t,e,n){return e in n}var Re=b(function(t,e){var n={},r=e[0];if(null==t)return n;$(r)?(e.length>1&&(r=Ct(r,e[1])),e=at(t)):(r=Fe,e=ee(e,!1,!1),t=Object(t));for(var i=0,o=e.length;i<o;i++){var a=e[i],u=t[a];r(u,a,t)&&(n[a]=u)}return n}),Be=b(function(t,e){var n,r=e[0];return $(r)?(r=oe(r),e.length>1&&(n=e[1])):(e=me(ee(e,!1,!1),String),r=function(t,n){return!Ae(e,n)}),Re(t,r,n)});function Le(t,e,n){return a.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))}function ze(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[0]:Le(t,t.length-e)}function qe(t,e,n){return a.call(t,null==e||n?1:e)}var Ke=b(function(t,e){return e=ee(e,!0,!0),xe(t,function(t){return!Ae(e,t)})}),Ue=b(function(t,e){return Ke(t,e)});function Ve(t,e,n,r){k(e)||(r=n,n=e,e=!1),null!=n&&(n=Pt(n,r));for(var i=[],o=[],a=0,u=X(t);a<u;a++){var s=t[a],c=n?n(s,a,t):s;e&&!n?(a&&o===c||i.push(s),o=c):n?Ae(o,c)||(o.push(c),i.push(s)):Ae(i,s)||i.push(s)}return i}var We=b(function(t){return Ve(ee(t,!0,!0))});function Je(t){for(var e=t&&je(t,X).length||0,n=Array(e),r=0;r<e;r++)n[r]=Ie(t,r);return n}var He=b(Je);function Ge(t,e){return t._chain?nt(e).chain():e}function Qe(t){return ge(bt(t),function(e){var n=nt[e]=t[e];nt.prototype[e]=function(){var t=[this._wrapped];return o.apply(t,arguments),Ge(this,n.apply(nt,t))}}),nt}ge(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];nt.prototype[t]=function(){var n=this._wrapped;return null!=n&&(e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0]),Ge(this,n)}}),ge(["concat","join","slice"],function(t){var e=n[t];nt.prototype[t]=function(){var t=this._wrapped;return null!=t&&(t=e.apply(t,arguments)),Ge(this,t)}});var Ye=Qe({__proto__:null,VERSION:"1.13.2",restArguments:b,isObject:w,isNull:function(t){return null===t},isUndefined:x,isBoolean:k,isElement:function(t){return!(!t||1!==t.nodeType)},isString:A,isNumber:O,isDate:I,isRegExp:j,isError:S,isSymbol:N,isArrayBuffer:D,isDataView:B,isArray:L,isFunction:$,isArguments:K,isFinite:function(t){return!N(t)&&v(t)&&!isNaN(parseFloat(t))},isNaN:U,isTypedArray:Y,isEmpty:function(t){if(null==t)return!0;var e=X(t);return"number"==typeof e&&(L(t)||A(t)||K(t))?0===e:0===X(tt(t))},isMatch:et,isEqual:function(t,e){return ot(t,e)},isMap:dt,isWeakMap:yt,isSet:vt,isWeakSet:gt,keys:tt,allKeys:at,values:mt,pairs:function(t){for(var e=tt(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=[e[i],t[e[i]]];return r},invert:_t,functions:bt,methods:bt,extend:xt,extendOwn:kt,assign:kt,defaults:Et,create:function(t,e){var n=At(t);return e&&kt(n,e),n},clone:function(t){return w(t)?L(t)?t.slice():xt({},t):t},tap:function(t,e){return e(t),t},get:St,has:function(t,e){for(var n=(e=It(e)).length,r=0;r<n;r++){var i=e[r];if(!z(t,i))return!1;t=t[i]}return!!n},mapObject:function(t,e,n){e=Pt(e,n);for(var r=tt(t),i=r.length,o={},a=0;a<i;a++){var u=r[a];o[u]=e(t[u],u,t)}return o},identity:Nt,constant:V,noop:Ft,toPath:Ot,property:Tt,propertyOf:function(t){return null==t?Ft:function(e){return St(t,e)}},matcher:Dt,matches:Dt,times:function(t,e,n){var r=Array(Math.max(0,t));e=Ct(e,n,1);for(var i=0;i<t;i++)r[i]=e(i);return r},random:Rt,now:Bt,escape:qt,unescape:Kt,templateSettings:Ut,template:function(t,e,n){!e&&n&&(e=n),e=Et({},e,nt.templateSettings);var r=RegExp([(e.escape||Vt).source,(e.interpolate||Vt).source,(e.evaluate||Vt).source].join("|")+"|$","g"),i=0,o="__p+='";t.replace(r,function(e,n,r,a,u){return o+=t.slice(i,u).replace(Jt,Ht),i=u+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?o+="'+\n((__t=("+r+"))==null?'':__t)+\n'":a&&(o+="';\n"+a+"\n__p+='"),e}),o+="';\n";var a,u=e.variable;if(u){if(!Gt.test(u))throw new Error("variable is not a bare identifier: "+u)}else o="with(obj||{}){\n"+o+"}\n",u="obj";o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{a=new Function(u,"_",o)}catch(t){throw t.source=o,t}var s=function(t){return a.call(this,t,nt)};return s.source="function("+u+"){\n"+o+"}",s},result:function(t,e,n){var r=(e=It(e)).length;if(!r)return $(n)?n.call(t):n;for(var i=0;i<r;i++){var o=null==t?void 0:t[e[i]];void 0===o&&(o=n,i=r),t=$(o)?o.call(t):o}return t},uniqueId:function(t){var e=++Qt+"";return t?t+e:e},chain:function(t){var e=nt(t);return e._chain=!0,e},iteratee:Mt,partial:Xt,bind:Zt,bindAll:ne,memoize:function(t,e){var n=function(r){var i=n.cache,o=""+(e?e.apply(this,arguments):r);return z(i,o)||(i[o]=t.apply(this,arguments)),i[o]};return n.cache={},n},delay:re,defer:ie,throttle:function(t,e,n){var r,i,o,a,u=0;n||(n={});var s=function(){u=!1===n.leading?0:Bt(),r=null,a=t.apply(i,o),r||(i=o=null)},c=function(){var c=Bt();u||!1!==n.leading||(u=c);var f=e-(c-u);return i=this,o=arguments,f<=0||f>e?(r&&(clearTimeout(r),r=null),u=c,a=t.apply(i,o),r||(i=o=null)):r||!1===n.trailing||(r=setTimeout(s,f)),a};return c.cancel=function(){clearTimeout(r),u=0,r=i=o=null},c},debounce:function(t,e,n){var r,i,o,a,u,s=function(){var c=Bt()-i;e>c?r=setTimeout(s,e-c):(r=null,n||(a=t.apply(u,o)),r||(o=u=null))},c=b(function(c){return u=this,o=c,i=Bt(),r||(r=setTimeout(s,e),n&&(a=t.apply(u,o))),a});return c.cancel=function(){clearTimeout(r),r=o=u=null},c},wrap:function(t,e){return Xt(e,t)},negate:oe,compose:function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},after:function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},before:ae,once:ue,findKey:se,findIndex:fe,findLastIndex:le,sortedIndex:he,indexOf:de,lastIndexOf:ye,find:ve,detect:ve,findWhere:function(t,e){return ve(t,Dt(e))},each:ge,forEach:ge,map:me,collect:me,reduce:be,foldl:be,inject:be,reduceRight:we,foldr:we,filter:xe,select:xe,reject:function(t,e,n){return xe(t,oe(Pt(e)),n)},every:ke,all:ke,some:Ee,any:Ee,contains:Ae,includes:Ae,include:Ae,invoke:Oe,pluck:Ie,where:function(t,e){return xe(t,Dt(e))},max:je,min:function(t,e,n){var r,i,o=1/0,a=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var u=0,s=(t=te(t)?t:mt(t)).length;u<s;u++)null!=(r=t[u])&&r<o&&(o=r);else e=Pt(e,n),ge(t,function(t,n,r){((i=e(t,n,r))<a||i===1/0&&o===1/0)&&(o=t,a=i)});return o},shuffle:function(t){return De(t,1/0)},sample:De,sortBy:function(t,e,n){var r=0;return e=Pt(e,n),Ie(me(t,function(t,n,i){return{value:t,index:r++,criteria:e(t,n,i)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index}),"value")},groupBy:Ce,indexBy:$e,countBy:Me,partition:Pe,toArray:Ne,size:function(t){return null==t?0:te(t)?t.length:tt(t).length},pick:Re,omit:Be,first:ze,head:ze,take:ze,initial:Le,last:function(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[t.length-1]:qe(t,Math.max(0,t.length-e))},rest:qe,tail:qe,drop:qe,compact:function(t){return xe(t,Boolean)},flatten:function(t,e){return ee(t,e,!1)},without:Ue,uniq:Ve,unique:Ve,union:We,intersection:function(t){for(var e=[],n=arguments.length,r=0,i=X(t);r<i;r++){var o=t[r];if(!Ae(e,o)){var a;for(a=1;a<n&&Ae(arguments[a],o);a++);a===n&&e.push(o)}}return e},difference:Ke,unzip:Je,transpose:Je,zip:He,object:function(t,e){for(var n={},r=0,i=X(t);r<i;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},range:function(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var r=Math.max(Math.ceil((e-t)/n),0),i=Array(r),o=0;o<r;o++,t+=n)i[o]=t;return i},chunk:function(t,e){if(null==e||e<1)return[];for(var n=[],r=0,i=t.length;r<i;)n.push(a.call(t,r,r+=e));return n},mixin:Qe,default:nt});return Ye._=Ye,Ye})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[13])(13)});